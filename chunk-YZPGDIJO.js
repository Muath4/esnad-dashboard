import{c as wt}from"./chunk-5KKSAYQM.js";import{a as ta,b as Ga}from"./chunk-NFKFJGEM.js";import{d as At}from"./chunk-5YHN6KDB.js";import{m as ft,o as aa}from"./chunk-BX6Q2EGA.js";import{Ea as Za,H as ja,I as rt,Ia as Fa,K as Xa,M as Ya,N as qa,Z as F,h as w,ha as J,j as I}from"./chunk-YMYRQ6W5.js";import{a as K,b as et,h as C}from"./chunk-FU75TI2F.js";function sa(i,t,e){if(i&&i.length){let[r,s]=t,n=Math.PI/180*e,o=Math.cos(n),a=Math.sin(n);for(let c of i){let[l,h]=c;c[0]=(l-r)*o-(h-s)*a+r,c[1]=(l-r)*a+(h-s)*o+s}}}function Ws(i,t){return i[0]===t[0]&&i[1]===t[1]}function Ns(i,t,e,r=1){let s=e,n=Math.max(t,.1),o=i[0]&&i[0][0]&&typeof i[0][0]=="number"?[i]:i,a=[0,0];if(s)for(let l of o)sa(l,a,s);let c=function(l,h,g){let f=[];for(let b of l){let m=[...b];Ws(m[0],m[m.length-1])||m.push([m[0][0],m[0][1]]),m.length>2&&f.push(m)}let p=[];h=Math.max(h,.1);let u=[];for(let b of f)for(let m=0;m<b.length-1;m++){let S=b[m],v=b[m+1];if(S[1]!==v[1]){let $=Math.min(S[1],v[1]);u.push({ymin:$,ymax:Math.max(S[1],v[1]),x:$===S[1]?S[0]:v[0],islope:(v[0]-S[0])/(v[1]-S[1])})}}if(u.sort((b,m)=>b.ymin<m.ymin?-1:b.ymin>m.ymin?1:b.x<m.x?-1:b.x>m.x?1:b.ymax===m.ymax?0:(b.ymax-m.ymax)/Math.abs(b.ymax-m.ymax)),!u.length)return p;let y=[],x=u[0].ymin,d=0;for(;y.length||u.length;){if(u.length){let b=-1;for(let m=0;m<u.length&&!(u[m].ymin>x);m++)b=m;u.splice(0,b+1).forEach(m=>{y.push({s:x,edge:m})})}if(y=y.filter(b=>!(b.edge.ymax<=x)),y.sort((b,m)=>b.edge.x===m.edge.x?0:(b.edge.x-m.edge.x)/Math.abs(b.edge.x-m.edge.x)),(g!==1||d%h==0)&&y.length>1)for(let b=0;b<y.length;b+=2){let m=b+1;if(m>=y.length)break;let S=y[b].edge,v=y[m].edge;p.push([[Math.round(S.x),x],[Math.round(v.x),x]])}x+=g,y.forEach(b=>{b.edge.x=b.edge.x+g*b.edge.islope}),d++}return p}(o,n,r);if(s){for(let l of o)sa(l,a,-s);(function(l,h,g){let f=[];l.forEach(p=>f.push(...p)),sa(f,h,g)})(c,a,-s)}return c}function vt(i,t){var e;let r=t.hachureAngle+90,s=t.hachureGap;s<0&&(s=4*t.strokeWidth),s=Math.round(Math.max(s,.1));let n=1;return t.roughness>=1&&(((e=t.randomizer)===null||e===void 0?void 0:e.next())||Math.random())>.7&&(n=s),Ns(i,s,r,n||1)}var St=class{constructor(t){this.helper=t}fillPolygons(t,e){return this._fillPolygons(t,e)}_fillPolygons(t,e){let r=vt(t,e);return{type:"fillSketch",ops:this.renderLines(r,e)}}renderLines(t,e){let r=[];for(let s of t)r.push(...this.helper.doubleLineOps(s[0][0],s[0][1],s[1][0],s[1][1],e));return r}};function It(i){let t=i[0],e=i[1];return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))}var la=class extends St{fillPolygons(t,e){let r=e.hachureGap;r<0&&(r=4*e.strokeWidth),r=Math.max(r,.1);let s=vt(t,Object.assign({},e,{hachureGap:r})),n=Math.PI/180*e.hachureAngle,o=[],a=.5*r*Math.cos(n),c=.5*r*Math.sin(n);for(let[l,h]of s)It([l,h])&&o.push([[l[0]-a,l[1]+c],[...h]],[[l[0]+a,l[1]-c],[...h]]);return{type:"fillSketch",ops:this.renderLines(o,e)}}},ca=class extends St{fillPolygons(t,e){let r=this._fillPolygons(t,e),s=Object.assign({},e,{hachureAngle:e.hachureAngle+90}),n=this._fillPolygons(t,s);return r.ops=r.ops.concat(n.ops),r}},oa=class{constructor(t){this.helper=t}fillPolygons(t,e){let r=vt(t,e=Object.assign({},e,{hachureAngle:0}));return this.dotsOnLines(r,e)}dotsOnLines(t,e){let r=[],s=e.hachureGap;s<0&&(s=4*e.strokeWidth),s=Math.max(s,.1);let n=e.fillWeight;n<0&&(n=e.strokeWidth/2);let o=s/4;for(let a of t){let c=It(a),l=c/s,h=Math.ceil(l)-1,g=c-h*s,f=(a[0][0]+a[1][0])/2-s/4,p=Math.min(a[0][1],a[1][1]);for(let u=0;u<h;u++){let y=p+g+u*s,x=f-o+2*Math.random()*o,d=y-o+2*Math.random()*o,b=this.helper.ellipse(x,d,n,n,e);r.push(...b.ops)}}return{type:"fillSketch",ops:r}}},ha=class{constructor(t){this.helper=t}fillPolygons(t,e){let r=vt(t,e);return{type:"fillSketch",ops:this.dashedLine(r,e)}}dashedLine(t,e){let r=e.dashOffset<0?e.hachureGap<0?4*e.strokeWidth:e.hachureGap:e.dashOffset,s=e.dashGap<0?e.hachureGap<0?4*e.strokeWidth:e.hachureGap:e.dashGap,n=[];return t.forEach(o=>{let a=It(o),c=Math.floor(a/(r+s)),l=(a+s-c*(r+s))/2,h=o[0],g=o[1];h[0]>g[0]&&(h=o[1],g=o[0]);let f=Math.atan((g[1]-h[1])/(g[0]-h[0]));for(let p=0;p<c;p++){let u=p*(r+s),y=u+r,x=[h[0]+u*Math.cos(f)+l*Math.cos(f),h[1]+u*Math.sin(f)+l*Math.sin(f)],d=[h[0]+y*Math.cos(f)+l*Math.cos(f),h[1]+y*Math.sin(f)+l*Math.sin(f)];n.push(...this.helper.doubleLineOps(x[0],x[1],d[0],d[1],e))}}),n}},pa=class{constructor(t){this.helper=t}fillPolygons(t,e){let r=e.hachureGap<0?4*e.strokeWidth:e.hachureGap,s=e.zigzagOffset<0?r:e.zigzagOffset,n=vt(t,e=Object.assign({},e,{hachureGap:r+s}));return{type:"fillSketch",ops:this.zigzagLines(n,s,e)}}zigzagLines(t,e,r){let s=[];return t.forEach(n=>{let o=It(n),a=Math.round(o/(2*e)),c=n[0],l=n[1];c[0]>l[0]&&(c=n[1],l=n[0]);let h=Math.atan((l[1]-c[1])/(l[0]-c[0]));for(let g=0;g<a;g++){let f=2*g*e,p=2*(g+1)*e,u=Math.sqrt(2*Math.pow(e,2)),y=[c[0]+f*Math.cos(h),c[1]+f*Math.sin(h)],x=[c[0]+p*Math.cos(h),c[1]+p*Math.sin(h)],d=[y[0]+u*Math.cos(h+Math.PI/4),y[1]+u*Math.sin(h+Math.PI/4)];s.push(...this.helper.doubleLineOps(y[0],y[1],d[0],d[1],r),...this.helper.doubleLineOps(d[0],d[1],x[0],x[1],r))}}),s}},tt={},ga=class{constructor(t){this.seed=t}next(){return this.seed?(2**31-1&(this.seed=Math.imul(48271,this.seed)))/2**31:Math.random()}},Es=0,ea=1,Va=2,Bt={A:7,a:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:2,t:2,V:1,v:1,Z:0,z:0};function ra(i,t){return i.type===t}function ba(i){let t=[],e=function(o){let a=new Array;for(;o!=="";)if(o.match(/^([ \t\r\n,]+)/))o=o.substr(RegExp.$1.length);else if(o.match(/^([aAcChHlLmMqQsStTvVzZ])/))a[a.length]={type:Es,text:RegExp.$1},o=o.substr(RegExp.$1.length);else{if(!o.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))return[];a[a.length]={type:ea,text:`${parseFloat(RegExp.$1)}`},o=o.substr(RegExp.$1.length)}return a[a.length]={type:Va,text:""},a}(i),r="BOD",s=0,n=e[s];for(;!ra(n,Va);){let o=0,a=[];if(r==="BOD"){if(n.text!=="M"&&n.text!=="m")return ba("M0,0"+i);s++,o=Bt[n.text],r=n.text}else ra(n,ea)?o=Bt[r]:(s++,o=Bt[n.text],r=n.text);if(!(s+o<e.length))throw new Error("Path data ended short");for(let c=s;c<s+o;c++){let l=e[c];if(!ra(l,ea))throw new Error("Param not a number: "+r+","+l.text);a[a.length]=+l.text}if(typeof Bt[r]!="number")throw new Error("Bad segment: "+r);{let c={key:r,data:a};t.push(c),s+=o,n=e[s],r==="M"&&(r="L"),r==="m"&&(r="l")}}return t}function es(i){let t=0,e=0,r=0,s=0,n=[];for(let{key:o,data:a}of i)switch(o){case"M":n.push({key:"M",data:[...a]}),[t,e]=a,[r,s]=a;break;case"m":t+=a[0],e+=a[1],n.push({key:"M",data:[t,e]}),r=t,s=e;break;case"L":n.push({key:"L",data:[...a]}),[t,e]=a;break;case"l":t+=a[0],e+=a[1],n.push({key:"L",data:[t,e]});break;case"C":n.push({key:"C",data:[...a]}),t=a[4],e=a[5];break;case"c":{let c=a.map((l,h)=>h%2?l+e:l+t);n.push({key:"C",data:c}),t=c[4],e=c[5];break}case"Q":n.push({key:"Q",data:[...a]}),t=a[2],e=a[3];break;case"q":{let c=a.map((l,h)=>h%2?l+e:l+t);n.push({key:"Q",data:c}),t=c[2],e=c[3];break}case"A":n.push({key:"A",data:[...a]}),t=a[5],e=a[6];break;case"a":t+=a[5],e+=a[6],n.push({key:"A",data:[a[0],a[1],a[2],a[3],a[4],t,e]});break;case"H":n.push({key:"H",data:[...a]}),t=a[0];break;case"h":t+=a[0],n.push({key:"H",data:[t]});break;case"V":n.push({key:"V",data:[...a]}),e=a[0];break;case"v":e+=a[0],n.push({key:"V",data:[e]});break;case"S":n.push({key:"S",data:[...a]}),t=a[2],e=a[3];break;case"s":{let c=a.map((l,h)=>h%2?l+e:l+t);n.push({key:"S",data:c}),t=c[2],e=c[3];break}case"T":n.push({key:"T",data:[...a]}),t=a[0],e=a[1];break;case"t":t+=a[0],e+=a[1],n.push({key:"T",data:[t,e]});break;case"Z":case"z":n.push({key:"Z",data:[]}),t=r,e=s}return n}function rs(i){let t=[],e="",r=0,s=0,n=0,o=0,a=0,c=0;for(let{key:l,data:h}of i){switch(l){case"M":t.push({key:"M",data:[...h]}),[r,s]=h,[n,o]=h;break;case"C":t.push({key:"C",data:[...h]}),r=h[4],s=h[5],a=h[2],c=h[3];break;case"L":t.push({key:"L",data:[...h]}),[r,s]=h;break;case"H":r=h[0],t.push({key:"L",data:[r,s]});break;case"V":s=h[0],t.push({key:"L",data:[r,s]});break;case"S":{let g=0,f=0;e==="C"||e==="S"?(g=r+(r-a),f=s+(s-c)):(g=r,f=s),t.push({key:"C",data:[g,f,...h]}),a=h[0],c=h[1],r=h[2],s=h[3];break}case"T":{let[g,f]=h,p=0,u=0;e==="Q"||e==="T"?(p=r+(r-a),u=s+(s-c)):(p=r,u=s);let y=r+2*(p-r)/3,x=s+2*(u-s)/3,d=g+2*(p-g)/3,b=f+2*(u-f)/3;t.push({key:"C",data:[y,x,d,b,g,f]}),a=p,c=u,r=g,s=f;break}case"Q":{let[g,f,p,u]=h,y=r+2*(g-r)/3,x=s+2*(f-s)/3,d=p+2*(g-p)/3,b=u+2*(f-u)/3;t.push({key:"C",data:[y,x,d,b,p,u]}),a=g,c=f,r=p,s=u;break}case"A":{let g=Math.abs(h[0]),f=Math.abs(h[1]),p=h[2],u=h[3],y=h[4],x=h[5],d=h[6];g===0||f===0?(t.push({key:"C",data:[r,s,x,d,x,d]}),r=x,s=d):(r!==x||s!==d)&&(ns(r,s,x,d,g,f,p,u,y).forEach(function(b){t.push({key:"C",data:b})}),r=x,s=d);break}case"Z":t.push({key:"Z",data:[]}),r=n,s=o}e=l}return t}function mt(i,t,e){return[i*Math.cos(e)-t*Math.sin(e),i*Math.sin(e)+t*Math.cos(e)]}function ns(i,t,e,r,s,n,o,a,c,l){let h=(g=o,Math.PI*g/180);var g;let f=[],p=0,u=0,y=0,x=0;if(l)[p,u,y,x]=l;else{[i,t]=mt(i,t,-h),[e,r]=mt(e,r,-h);let q=(i-e)/2,X=(t-r)/2,Y=q*q/(s*s)+X*X/(n*n);Y>1&&(Y=Math.sqrt(Y),s*=Y,n*=Y);let B=s*s,O=n*n,P=B*O-B*X*X-O*q*q,H=B*X*X+O*q*q,_=(a===c?-1:1)*Math.sqrt(Math.abs(P/H));y=_*s*X/n+(i+e)/2,x=_*-n*q/s+(t+r)/2,p=Math.asin(parseFloat(((t-x)/n).toFixed(9))),u=Math.asin(parseFloat(((r-x)/n).toFixed(9))),i<y&&(p=Math.PI-p),e<y&&(u=Math.PI-u),p<0&&(p=2*Math.PI+p),u<0&&(u=2*Math.PI+u),c&&p>u&&(p-=2*Math.PI),!c&&u>p&&(u-=2*Math.PI)}let d=u-p;if(Math.abs(d)>120*Math.PI/180){let q=u,X=e,Y=r;u=c&&u>p?p+120*Math.PI/180*1:p+120*Math.PI/180*-1,f=ns(e=y+s*Math.cos(u),r=x+n*Math.sin(u),X,Y,s,n,o,0,c,[u,q,y,x])}d=u-p;let b=Math.cos(p),m=Math.sin(p),S=Math.cos(u),v=Math.sin(u),$=Math.tan(d/4),D=4/3*s*$,M=4/3*n*$,R=[i,t],E=[i+D*m,t-M*b],Z=[e+D*v,r-M*S],V=[e,r];if(E[0]=2*R[0]-E[0],E[1]=2*R[1]-E[1],l)return[E,Z,V].concat(f);{f=[E,Z,V].concat(f);let q=[];for(let X=0;X<f.length;X+=3){let Y=mt(f[X][0],f[X][1],h),B=mt(f[X+1][0],f[X+1][1],h),O=mt(f[X+2][0],f[X+2][1],h);q.push([Y[0],Y[1],B[0],B[1],O[0],O[1]])}return q}}var Ts={randOffset:function(i,t){return T(i,t)},randOffsetWithRange:function(i,t,e){return Ot(i,t,e)},ellipse:function(i,t,e,r,s){let n=ls(e,r,s);return fa(i,t,s,n).opset},doubleLineOps:function(i,t,e,r,s){return ct(i,t,e,r,s,!0)}};function is(i,t,e,r,s){return{type:"path",ops:ct(i,t,e,r,s)}}function Et(i,t,e){let r=(i||[]).length;if(r>2){let s=[];for(let n=0;n<r-1;n++)s.push(...ct(i[n][0],i[n][1],i[n+1][0],i[n+1][1],e));return t&&s.push(...ct(i[r-1][0],i[r-1][1],i[0][0],i[0][1],e)),{type:"path",ops:s}}return r===2?is(i[0][0],i[0][1],i[1][0],i[1][1],e):{type:"path",ops:[]}}function Os(i,t,e,r,s){return function(n,o){return Et(n,!0,o)}([[i,t],[i+e,t],[i+e,t+r],[i,t+r]],s)}function Qa(i,t){if(i.length){let e=typeof i[0][0]=="number"?[i]:i,r=Wt(e[0],1*(1+.2*t.roughness),t),s=t.disableMultiStroke?[]:Wt(e[0],1.5*(1+.22*t.roughness),Ka(t));for(let n=1;n<e.length;n++){let o=e[n];if(o.length){let a=Wt(o,1*(1+.2*t.roughness),t),c=t.disableMultiStroke?[]:Wt(o,1.5*(1+.22*t.roughness),Ka(t));for(let l of a)l.op!=="move"&&r.push(l);for(let l of c)l.op!=="move"&&s.push(l)}}return{type:"path",ops:r.concat(s)}}return{type:"path",ops:[]}}function ls(i,t,e){let r=Math.sqrt(2*Math.PI*Math.sqrt((Math.pow(i/2,2)+Math.pow(t/2,2))/2)),s=Math.ceil(Math.max(e.curveStepCount,e.curveStepCount/Math.sqrt(200)*r)),n=2*Math.PI/s,o=Math.abs(i/2),a=Math.abs(t/2),c=1-e.curveFitting;return o+=T(o*c,e),a+=T(a*c,e),{increment:n,rx:o,ry:a}}function fa(i,t,e,r){let[s,n]=ts(r.increment,i,t,r.rx,r.ry,1,r.increment*Ot(.1,Ot(.4,1,e),e),e),o=_t(s,null,e);if(!e.disableMultiStroke&&e.roughness!==0){let[a]=ts(r.increment,i,t,r.rx,r.ry,1.5,0,e),c=_t(a,null,e);o=o.concat(c)}return{estimatedPoints:n,opset:{type:"path",ops:o}}}function Ua(i,t,e,r,s,n,o,a,c){let l=i,h=t,g=Math.abs(e/2),f=Math.abs(r/2);g+=T(.01*g,c),f+=T(.01*f,c);let p=s,u=n;for(;p<0;)p+=2*Math.PI,u+=2*Math.PI;u-p>2*Math.PI&&(p=0,u=2*Math.PI);let y=2*Math.PI/c.curveStepCount,x=Math.min(y/2,(u-p)/2),d=as(x,l,h,g,f,p,u,1,c);if(!c.disableMultiStroke){let b=as(x,l,h,g,f,p,u,1.5,c);d.push(...b)}return o&&(a?d.push(...ct(l,h,l+g*Math.cos(p),h+f*Math.sin(p),c),...ct(l,h,l+g*Math.cos(u),h+f*Math.sin(u),c)):d.push({op:"lineTo",data:[l,h]},{op:"lineTo",data:[l+g*Math.cos(p),h+f*Math.sin(p)]})),{type:"path",ops:d}}function Ja(i,t){let e=rs(es(ba(i))),r=[],s=[0,0],n=[0,0];for(let{key:o,data:a}of e)switch(o){case"M":n=[a[0],a[1]],s=[a[0],a[1]];break;case"L":r.push(...ct(n[0],n[1],a[0],a[1],t)),n=[a[0],a[1]];break;case"C":{let[c,l,h,g,f,p]=a;r.push(..._s(c,l,h,g,f,p,n,t)),n=[f,p];break}case"Z":r.push(...ct(n[0],n[1],s[0],s[1],t)),n=[s[0],s[1]]}return{type:"path",ops:r}}function na(i,t){let e=[];for(let r of i)if(r.length){let s=t.maxRandomnessOffset||0,n=r.length;if(n>2){e.push({op:"move",data:[r[0][0]+T(s,t),r[0][1]+T(s,t)]});for(let o=1;o<n;o++)e.push({op:"lineTo",data:[r[o][0]+T(s,t),r[o][1]+T(s,t)]})}}return{type:"fillPath",ops:e}}function ut(i,t){return function(e,r){let s=e.fillStyle||"hachure";if(!tt[s])switch(s){case"zigzag":tt[s]||(tt[s]=new la(r));break;case"cross-hatch":tt[s]||(tt[s]=new ca(r));break;case"dots":tt[s]||(tt[s]=new oa(r));break;case"dashed":tt[s]||(tt[s]=new ha(r));break;case"zigzag-line":tt[s]||(tt[s]=new pa(r));break;default:s="hachure",tt[s]||(tt[s]=new St(r))}return tt[s]}(t,Ts).fillPolygons(i,t)}function Ka(i){let t=Object.assign({},i);return t.randomizer=void 0,i.seed&&(t.seed=i.seed+1),t}function cs(i){return i.randomizer||(i.randomizer=new ga(i.seed||0)),i.randomizer.next()}function Ot(i,t,e,r=1){return e.roughness*r*(cs(e)*(t-i)+i)}function T(i,t,e=1){return Ot(-i,i,t,e)}function ct(i,t,e,r,s,n=!1){let o=n?s.disableMultiStrokeFill:s.disableMultiStroke,a=ua(i,t,e,r,s,!0,!1);if(o)return a;let c=ua(i,t,e,r,s,!0,!0);return a.concat(c)}function ua(i,t,e,r,s,n,o){let a=Math.pow(i-e,2)+Math.pow(t-r,2),c=Math.sqrt(a),l=1;l=c<200?1:c>500?.4:-.0016668*c+1.233334;let h=s.maxRandomnessOffset||0;h*h*100>a&&(h=c/10);let g=h/2,f=.2+.2*cs(s),p=s.bowing*s.maxRandomnessOffset*(r-t)/200,u=s.bowing*s.maxRandomnessOffset*(i-e)/200;p=T(p,s,l),u=T(u,s,l);let y=[],x=()=>T(g,s,l),d=()=>T(h,s,l),b=s.preserveVertices;return n&&(o?y.push({op:"move",data:[i+(b?0:x()),t+(b?0:x())]}):y.push({op:"move",data:[i+(b?0:T(h,s,l)),t+(b?0:T(h,s,l))]})),o?y.push({op:"bcurveTo",data:[p+i+(e-i)*f+x(),u+t+(r-t)*f+x(),p+i+2*(e-i)*f+x(),u+t+2*(r-t)*f+x(),e+(b?0:x()),r+(b?0:x())]}):y.push({op:"bcurveTo",data:[p+i+(e-i)*f+d(),u+t+(r-t)*f+d(),p+i+2*(e-i)*f+d(),u+t+2*(r-t)*f+d(),e+(b?0:d()),r+(b?0:d())]}),y}function Wt(i,t,e){if(!i.length)return[];let r=[];r.push([i[0][0]+T(t,e),i[0][1]+T(t,e)]),r.push([i[0][0]+T(t,e),i[0][1]+T(t,e)]);for(let s=1;s<i.length;s++)r.push([i[s][0]+T(t,e),i[s][1]+T(t,e)]),s===i.length-1&&r.push([i[s][0]+T(t,e),i[s][1]+T(t,e)]);return _t(r,null,e)}function _t(i,t,e){let r=i.length,s=[];if(r>3){let n=[],o=1-e.curveTightness;s.push({op:"move",data:[i[1][0],i[1][1]]});for(let a=1;a+2<r;a++){let c=i[a];n[0]=[c[0],c[1]],n[1]=[c[0]+(o*i[a+1][0]-o*i[a-1][0])/6,c[1]+(o*i[a+1][1]-o*i[a-1][1])/6],n[2]=[i[a+1][0]+(o*i[a][0]-o*i[a+2][0])/6,i[a+1][1]+(o*i[a][1]-o*i[a+2][1])/6],n[3]=[i[a+1][0],i[a+1][1]],s.push({op:"bcurveTo",data:[n[1][0],n[1][1],n[2][0],n[2][1],n[3][0],n[3][1]]})}if(t&&t.length===2){let a=e.maxRandomnessOffset;s.push({op:"lineTo",data:[t[0]+T(a,e),t[1]+T(a,e)]})}}else r===3?(s.push({op:"move",data:[i[1][0],i[1][1]]}),s.push({op:"bcurveTo",data:[i[1][0],i[1][1],i[2][0],i[2][1],i[2][0],i[2][1]]})):r===2&&s.push(...ua(i[0][0],i[0][1],i[1][0],i[1][1],e,!0,!0));return s}function ts(i,t,e,r,s,n,o,a){let c=[],l=[];if(a.roughness===0){i/=4,l.push([t+r*Math.cos(-i),e+s*Math.sin(-i)]);for(let h=0;h<=2*Math.PI;h+=i){let g=[t+r*Math.cos(h),e+s*Math.sin(h)];c.push(g),l.push(g)}l.push([t+r*Math.cos(0),e+s*Math.sin(0)]),l.push([t+r*Math.cos(i),e+s*Math.sin(i)])}else{let h=T(.5,a)-Math.PI/2;l.push([T(n,a)+t+.9*r*Math.cos(h-i),T(n,a)+e+.9*s*Math.sin(h-i)]);let g=2*Math.PI+h-.01;for(let f=h;f<g;f+=i){let p=[T(n,a)+t+r*Math.cos(f),T(n,a)+e+s*Math.sin(f)];c.push(p),l.push(p)}l.push([T(n,a)+t+r*Math.cos(h+2*Math.PI+.5*o),T(n,a)+e+s*Math.sin(h+2*Math.PI+.5*o)]),l.push([T(n,a)+t+.98*r*Math.cos(h+o),T(n,a)+e+.98*s*Math.sin(h+o)]),l.push([T(n,a)+t+.9*r*Math.cos(h+.5*o),T(n,a)+e+.9*s*Math.sin(h+.5*o)])}return[l,c]}function as(i,t,e,r,s,n,o,a,c){let l=n+T(.1,c),h=[];h.push([T(a,c)+t+.9*r*Math.cos(l-i),T(a,c)+e+.9*s*Math.sin(l-i)]);for(let g=l;g<=o;g+=i)h.push([T(a,c)+t+r*Math.cos(g),T(a,c)+e+s*Math.sin(g)]);return h.push([t+r*Math.cos(o),e+s*Math.sin(o)]),h.push([t+r*Math.cos(o),e+s*Math.sin(o)]),_t(h,null,c)}function _s(i,t,e,r,s,n,o,a){let c=[],l=[a.maxRandomnessOffset||1,(a.maxRandomnessOffset||1)+.3],h=[0,0],g=a.disableMultiStroke?1:2,f=a.preserveVertices;for(let p=0;p<g;p++)p===0?c.push({op:"move",data:[o[0],o[1]]}):c.push({op:"move",data:[o[0]+(f?0:T(l[0],a)),o[1]+(f?0:T(l[0],a))]}),h=f?[s,n]:[s+T(l[p],a),n+T(l[p],a)],c.push({op:"bcurveTo",data:[i+T(l[p],a),t+T(l[p],a),e+T(l[p],a),r+T(l[p],a),h[0],h[1]]});return c}function kt(i){return[...i]}function ss(i,t=0){let e=i.length;if(e<3)throw new Error("A curve must have at least three points.");let r=[];if(e===3)r.push(kt(i[0]),kt(i[1]),kt(i[2]),kt(i[2]));else{let s=[];s.push(i[0],i[0]);for(let a=1;a<i.length;a++)s.push(i[a]),a===i.length-1&&s.push(i[a]);let n=[],o=1-t;r.push(kt(s[0]));for(let a=1;a+2<s.length;a++){let c=s[a];n[0]=[c[0],c[1]],n[1]=[c[0]+(o*s[a+1][0]-o*s[a-1][0])/6,c[1]+(o*s[a+1][1]-o*s[a-1][1])/6],n[2]=[s[a+1][0]+(o*s[a][0]-o*s[a+2][0])/6,s[a+1][1]+(o*s[a][1]-o*s[a+2][1])/6],n[3]=[s[a+1][0],s[a+1][1]],r.push(n[1],n[2],n[3])}}return r}function Tt(i,t){return Math.pow(i[0]-t[0],2)+Math.pow(i[1]-t[1],2)}function Hs(i,t,e){let r=Tt(t,e);if(r===0)return Tt(i,t);let s=((i[0]-t[0])*(e[0]-t[0])+(i[1]-t[1])*(e[1]-t[1]))/r;return s=Math.max(0,Math.min(1,s)),Tt(i,pt(t,e,s))}function pt(i,t,e){return[i[0]+(t[0]-i[0])*e,i[1]+(t[1]-i[1])*e]}function ya(i,t,e,r){let s=r||[];if(function(a,c){let l=a[c+0],h=a[c+1],g=a[c+2],f=a[c+3],p=3*h[0]-2*l[0]-f[0];p*=p;let u=3*h[1]-2*l[1]-f[1];u*=u;let y=3*g[0]-2*f[0]-l[0];y*=y;let x=3*g[1]-2*f[1]-l[1];return x*=x,p<y&&(p=y),u<x&&(u=x),p+u}(i,t)<e){let a=i[t+0];s.length?(n=s[s.length-1],o=a,Math.sqrt(Tt(n,o))>1&&s.push(a)):s.push(a),s.push(i[t+3])}else{let c=i[t+0],l=i[t+1],h=i[t+2],g=i[t+3],f=pt(c,l,.5),p=pt(l,h,.5),u=pt(h,g,.5),y=pt(f,p,.5),x=pt(p,u,.5),d=pt(y,x,.5);ya([c,f,y,d],0,e,s),ya([d,x,u,g],0,e,s)}var n,o;return s}function Is(i,t){return Ht(i,0,i.length,t)}function Ht(i,t,e,r,s){let n=s||[],o=i[t],a=i[e-1],c=0,l=1;for(let h=t+1;h<e-1;++h){let g=Hs(i[h],o,a);g>c&&(c=g,l=h)}return Math.sqrt(c)>r?(Ht(i,t,l+1,r,n),Ht(i,l,e,r,n)):(n.length||n.push(o),n.push(a)),n}function ia(i,t=.15,e){let r=[],s=(i.length-1)/3;for(let n=0;n<s;n++)ya(i,3*n,t,r);return e&&e>0?Ht(r,0,r.length,e):r}var at="none",yt=class{constructor(t){this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveFitting:.95,curveStepCount:9,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1,dashOffset:-1,dashGap:-1,zigzagOffset:-1,seed:0,disableMultiStroke:!1,disableMultiStrokeFill:!1,preserveVertices:!1,fillShapeRoughnessGain:.8},this.config=t||{},this.config.options&&(this.defaultOptions=this._o(this.config.options))}static newSeed(){return Math.floor(Math.random()*2**31)}_o(t){return t?Object.assign({},this.defaultOptions,t):this.defaultOptions}_d(t,e,r){return{shape:t,sets:e||[],options:r||this.defaultOptions}}line(t,e,r,s,n){let o=this._o(n);return this._d("line",[is(t,e,r,s,o)],o)}rectangle(t,e,r,s,n){let o=this._o(n),a=[],c=Os(t,e,r,s,o);if(o.fill){let l=[[t,e],[t+r,e],[t+r,e+s],[t,e+s]];o.fillStyle==="solid"?a.push(na([l],o)):a.push(ut([l],o))}return o.stroke!==at&&a.push(c),this._d("rectangle",a,o)}ellipse(t,e,r,s,n){let o=this._o(n),a=[],c=ls(r,s,o),l=fa(t,e,o,c);if(o.fill)if(o.fillStyle==="solid"){let h=fa(t,e,o,c).opset;h.type="fillPath",a.push(h)}else a.push(ut([l.estimatedPoints],o));return o.stroke!==at&&a.push(l.opset),this._d("ellipse",a,o)}circle(t,e,r,s){let n=this.ellipse(t,e,r,r,s);return n.shape="circle",n}linearPath(t,e){let r=this._o(e);return this._d("linearPath",[Et(t,!1,r)],r)}arc(t,e,r,s,n,o,a=!1,c){let l=this._o(c),h=[],g=Ua(t,e,r,s,n,o,a,!0,l);if(a&&l.fill)if(l.fillStyle==="solid"){let f=Object.assign({},l);f.disableMultiStroke=!0;let p=Ua(t,e,r,s,n,o,!0,!1,f);p.type="fillPath",h.push(p)}else h.push(function(f,p,u,y,x,d,b){let m=f,S=p,v=Math.abs(u/2),$=Math.abs(y/2);v+=T(.01*v,b),$+=T(.01*$,b);let D=x,M=d;for(;D<0;)D+=2*Math.PI,M+=2*Math.PI;M-D>2*Math.PI&&(D=0,M=2*Math.PI);let R=(M-D)/b.curveStepCount,E=[];for(let Z=D;Z<=M;Z+=R)E.push([m+v*Math.cos(Z),S+$*Math.sin(Z)]);return E.push([m+v*Math.cos(M),S+$*Math.sin(M)]),E.push([m,S]),ut([E],b)}(t,e,r,s,n,o,l));return l.stroke!==at&&h.push(g),this._d("arc",h,l)}curve(t,e){let r=this._o(e),s=[],n=Qa(t,r);if(r.fill&&r.fill!==at)if(r.fillStyle==="solid"){let o=Qa(t,Object.assign(Object.assign({},r),{disableMultiStroke:!0,roughness:r.roughness?r.roughness+r.fillShapeRoughnessGain:0}));s.push({type:"fillPath",ops:this._mergedShape(o.ops)})}else{let o=[],a=t;if(a.length){let c=typeof a[0][0]=="number"?[a]:a;for(let l of c)l.length<3?o.push(...l):l.length===3?o.push(...ia(ss([l[0],l[0],l[1],l[2]]),10,(1+r.roughness)/2)):o.push(...ia(ss(l),10,(1+r.roughness)/2))}o.length&&s.push(ut([o],r))}return r.stroke!==at&&s.push(n),this._d("curve",s,r)}polygon(t,e){let r=this._o(e),s=[],n=Et(t,!0,r);return r.fill&&(r.fillStyle==="solid"?s.push(na([t],r)):s.push(ut([t],r))),r.stroke!==at&&s.push(n),this._d("polygon",s,r)}path(t,e){let r=this._o(e),s=[];if(!t)return this._d("path",s,r);t=(t||"").replace(/\n/g," ").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");let n=r.fill&&r.fill!=="transparent"&&r.fill!==at,o=r.stroke!==at,a=!!(r.simplification&&r.simplification<1),c=function(h,g,f){let p=rs(es(ba(h))),u=[],y=[],x=[0,0],d=[],b=()=>{d.length>=4&&y.push(...ia(d,g)),d=[]},m=()=>{b(),y.length&&(u.push(y),y=[])};for(let{key:v,data:$}of p)switch(v){case"M":m(),x=[$[0],$[1]],y.push(x);break;case"L":b(),y.push([$[0],$[1]]);break;case"C":if(!d.length){let D=y.length?y[y.length-1]:x;d.push([D[0],D[1]])}d.push([$[0],$[1]]),d.push([$[2],$[3]]),d.push([$[4],$[5]]);break;case"Z":b(),y.push([x[0],x[1]])}if(m(),!f)return u;let S=[];for(let v of u){let $=Is(v,f);$.length&&S.push($)}return S}(t,1,a?4-4*(r.simplification||1):(1+r.roughness)/2),l=Ja(t,r);if(n)if(r.fillStyle==="solid")if(c.length===1){let h=Ja(t,Object.assign(Object.assign({},r),{disableMultiStroke:!0,roughness:r.roughness?r.roughness+r.fillShapeRoughnessGain:0}));s.push({type:"fillPath",ops:this._mergedShape(h.ops)})}else s.push(na(c,r));else s.push(ut(c,r));return o&&(a?c.forEach(h=>{s.push(Et(h,!1,r))}):s.push(l)),this._d("path",s,r)}opsToPath(t,e){let r="";for(let s of t.ops){let n=typeof e=="number"&&e>=0?s.data.map(o=>+o.toFixed(e)):s.data;switch(s.op){case"move":r+=`M${n[0]} ${n[1]} `;break;case"bcurveTo":r+=`C${n[0]} ${n[1]}, ${n[2]} ${n[3]}, ${n[4]} ${n[5]} `;break;case"lineTo":r+=`L${n[0]} ${n[1]} `}}return r.trim()}toPaths(t){let e=t.sets||[],r=t.options||this.defaultOptions,s=[];for(let n of e){let o=null;switch(n.type){case"path":o={d:this.opsToPath(n),stroke:r.stroke,strokeWidth:r.strokeWidth,fill:at};break;case"fillPath":o={d:this.opsToPath(n),stroke:at,strokeWidth:0,fill:r.fill||at};break;case"fillSketch":o=this.fillSketch(n,r)}o&&s.push(o)}return s}fillSketch(t,e){let r=e.fillWeight;return r<0&&(r=e.strokeWidth/2),{d:this.opsToPath(t),stroke:e.fill||at,strokeWidth:r,fill:at}}_mergedShape(t){return t.filter((e,r)=>r===0||e.op!=="move")}},da=class{constructor(t,e){this.canvas=t,this.ctx=this.canvas.getContext("2d"),this.gen=new yt(e)}draw(t){let e=t.sets||[],r=t.options||this.getDefaultOptions(),s=this.ctx,n=t.options.fixedDecimalPlaceDigits;for(let o of e)switch(o.type){case"path":s.save(),s.strokeStyle=r.stroke==="none"?"transparent":r.stroke,s.lineWidth=r.strokeWidth,r.strokeLineDash&&s.setLineDash(r.strokeLineDash),r.strokeLineDashOffset&&(s.lineDashOffset=r.strokeLineDashOffset),this._drawToContext(s,o,n),s.restore();break;case"fillPath":{s.save(),s.fillStyle=r.fill||"";let a=t.shape==="curve"||t.shape==="polygon"||t.shape==="path"?"evenodd":"nonzero";this._drawToContext(s,o,n,a),s.restore();break}case"fillSketch":this.fillSketch(s,o,r)}}fillSketch(t,e,r){let s=r.fillWeight;s<0&&(s=r.strokeWidth/2),t.save(),r.fillLineDash&&t.setLineDash(r.fillLineDash),r.fillLineDashOffset&&(t.lineDashOffset=r.fillLineDashOffset),t.strokeStyle=r.fill||"",t.lineWidth=s,this._drawToContext(t,e,r.fixedDecimalPlaceDigits),t.restore()}_drawToContext(t,e,r,s="nonzero"){t.beginPath();for(let n of e.ops){let o=typeof r=="number"&&r>=0?n.data.map(a=>+a.toFixed(r)):n.data;switch(n.op){case"move":t.moveTo(o[0],o[1]);break;case"bcurveTo":t.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5]);break;case"lineTo":t.lineTo(o[0],o[1])}}e.type==="fillPath"?t.fill(s):t.stroke()}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}line(t,e,r,s,n){let o=this.gen.line(t,e,r,s,n);return this.draw(o),o}rectangle(t,e,r,s,n){let o=this.gen.rectangle(t,e,r,s,n);return this.draw(o),o}ellipse(t,e,r,s,n){let o=this.gen.ellipse(t,e,r,s,n);return this.draw(o),o}circle(t,e,r,s){let n=this.gen.circle(t,e,r,s);return this.draw(n),n}linearPath(t,e){let r=this.gen.linearPath(t,e);return this.draw(r),r}polygon(t,e){let r=this.gen.polygon(t,e);return this.draw(r),r}arc(t,e,r,s,n,o,a=!1,c){let l=this.gen.arc(t,e,r,s,n,o,a,c);return this.draw(l),l}curve(t,e){let r=this.gen.curve(t,e);return this.draw(r),r}path(t,e){let r=this.gen.path(t,e);return this.draw(r),r}},Nt="http://www.w3.org/2000/svg",xa=class{constructor(t,e){this.svg=t,this.gen=new yt(e)}draw(t){let e=t.sets||[],r=t.options||this.getDefaultOptions(),s=this.svg.ownerDocument||window.document,n=s.createElementNS(Nt,"g"),o=t.options.fixedDecimalPlaceDigits;for(let a of e){let c=null;switch(a.type){case"path":c=s.createElementNS(Nt,"path"),c.setAttribute("d",this.opsToPath(a,o)),c.setAttribute("stroke",r.stroke),c.setAttribute("stroke-width",r.strokeWidth+""),c.setAttribute("fill","none"),r.strokeLineDash&&c.setAttribute("stroke-dasharray",r.strokeLineDash.join(" ").trim()),r.strokeLineDashOffset&&c.setAttribute("stroke-dashoffset",`${r.strokeLineDashOffset}`);break;case"fillPath":c=s.createElementNS(Nt,"path"),c.setAttribute("d",this.opsToPath(a,o)),c.setAttribute("stroke","none"),c.setAttribute("stroke-width","0"),c.setAttribute("fill",r.fill||""),t.shape!=="curve"&&t.shape!=="polygon"||c.setAttribute("fill-rule","evenodd");break;case"fillSketch":c=this.fillSketch(s,a,r)}c&&n.appendChild(c)}return n}fillSketch(t,e,r){let s=r.fillWeight;s<0&&(s=r.strokeWidth/2);let n=t.createElementNS(Nt,"path");return n.setAttribute("d",this.opsToPath(e,r.fixedDecimalPlaceDigits)),n.setAttribute("stroke",r.fill||""),n.setAttribute("stroke-width",s+""),n.setAttribute("fill","none"),r.fillLineDash&&n.setAttribute("stroke-dasharray",r.fillLineDash.join(" ").trim()),r.fillLineDashOffset&&n.setAttribute("stroke-dashoffset",`${r.fillLineDashOffset}`),n}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}opsToPath(t,e){return this.gen.opsToPath(t,e)}line(t,e,r,s,n){let o=this.gen.line(t,e,r,s,n);return this.draw(o)}rectangle(t,e,r,s,n){let o=this.gen.rectangle(t,e,r,s,n);return this.draw(o)}ellipse(t,e,r,s,n){let o=this.gen.ellipse(t,e,r,s,n);return this.draw(o)}circle(t,e,r,s){let n=this.gen.circle(t,e,r,s);return this.draw(n)}linearPath(t,e){let r=this.gen.linearPath(t,e);return this.draw(r)}polygon(t,e){let r=this.gen.polygon(t,e);return this.draw(r)}arc(t,e,r,s,n,o,a=!1,c){let l=this.gen.arc(t,e,r,s,n,o,a,c);return this.draw(l)}curve(t,e){let r=this.gen.curve(t,e);return this.draw(r)}path(t,e){let r=this.gen.path(t,e);return this.draw(r)}},k={canvas:(i,t)=>new da(i,t),svg:(i,t)=>new xa(i,t),generator:i=>new yt(i),newSeed:()=>yt.newSeed()};var zs=w((i,t)=>{var e=i.x,r=i.y,s=t.x-e,n=t.y-r,o=i.width/2,a=i.height/2,c,l;return Math.abs(n)*o>Math.abs(s)*a?(n<0&&(a=-a),c=n===0?0:a*s/n,l=a):(s<0&&(o=-o),c=o,l=s===0?0:o*n/s),{x:e+c,y:r+l}},"intersectRect"),Rt=zs;function ms(i,t){t&&i.attr("style",t)}w(ms,"applyStyle");function ks(i){return C(this,null,function*(){let t=J(document.createElementNS("http://www.w3.org/2000/svg","foreignObject")),e=t.append("xhtml:div"),r=i.label;i.label&&Xa(i.label)&&(r=yield Ya(i.label.replace(qa.lineBreakRegex,`
`),F()));let s=i.isNode?"nodeLabel":"edgeLabel";return e.html('<span class="'+s+'" '+(i.labelStyle?'style="'+i.labelStyle+'"':"")+">"+r+"</span>"),ms(e,i.labelStyle),e.style("display","inline-block"),e.style("padding-right","1px"),e.style("white-space","nowrap"),e.attr("xmlns","http://www.w3.org/1999/xhtml"),t.node()})}w(ks,"addHtmlLabel");var js=w((i,t,e,r)=>C(void 0,null,function*(){let s=i||"";if(typeof s=="object"&&(s=s[0]),rt(F().flowchart.htmlLabels)){s=s.replace(/\\n|\n/g,"<br />"),I.info("vertexText"+s);let n={isNode:r,label:aa(s).replace(/fa[blrs]?:fa-[\w-]+/g,a=>`<i class='${a.replace(":"," ")}'></i>`),labelStyle:t&&t.replace("fill:","color:")};return yield ks(n)}else{let n=document.createElementNS("http://www.w3.org/2000/svg","text");n.setAttribute("style",t.replace("color:","fill:"));let o=[];typeof s=="string"?o=s.split(/\\n|\n|<br\s*\/?>/gi):Array.isArray(s)?o=s:o=[];for(let a of o){let c=document.createElementNS("http://www.w3.org/2000/svg","tspan");c.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),c.setAttribute("dy","1em"),c.setAttribute("x","0"),e?c.setAttribute("class","title-row"):c.setAttribute("class","row"),c.textContent=a.trim(),n.appendChild(c)}return n}}),"createLabel"),gt=js,xt=w((i,t,e,r,s)=>["M",i+s,t,"H",i+e-s,"A",s,s,0,0,1,i+e,t+s,"V",t+r-s,"A",s,s,0,0,1,i+e-s,t+r,"H",i+s,"A",s,s,0,0,1,i,t+r-s,"V",t+s,"A",s,s,0,0,1,i+s,t,"Z"].join(" "),"createRoundedRectPathD"),Xs=w(i=>{let{handDrawnSeed:t}=F();return{fill:i,hachureAngle:120,hachureGap:4,fillWeight:2,roughness:.7,stroke:i,seed:t}},"solidStateFill"),bt=w(i=>{let t=Ys([...i.cssCompiledStyles||[],...i.cssStyles||[]]);return{stylesMap:t,stylesArray:[...t]}},"compileStyles"),Ys=w(i=>{let t=new Map;return i.forEach(e=>{let[r,s]=e.split(":");t.set(r.trim(),s?.trim())}),t},"styles2Map"),N=w(i=>{let{stylesArray:t}=bt(i),e=[],r=[],s=[],n=[];return t.forEach(o=>{let a=o[0];a==="color"||a==="font-size"||a==="font-family"||a==="font-weight"||a==="font-style"||a==="text-decoration"||a==="text-align"||a==="text-transform"||a==="line-height"||a==="letter-spacing"||a==="word-spacing"||a==="text-shadow"||a==="text-overflow"||a==="white-space"||a==="word-wrap"||a==="word-break"||a==="overflow-wrap"||a==="hyphens"?e.push(o.join(":")+" !important"):(r.push(o.join(":")+" !important"),a.includes("stroke")&&s.push(o.join(":")+" !important"),a==="fill"&&n.push(o.join(":")+" !important"))}),{labelStyles:e.join(";"),nodeStyles:r.join(";"),stylesArray:t,borderStyles:s,backgroundStyles:n}},"styles2String"),A=w((i,t)=>{let{themeVariables:e,handDrawnSeed:r}=F(),{nodeBorder:s,mainBkg:n}=e,{stylesMap:o}=bt(i);return Object.assign({roughness:.7,fill:o.get("fill")||n,fillStyle:"hachure",fillWeight:4,hachureGap:5.2,stroke:o.get("stroke")||s,seed:r,strokeWidth:o.get("stroke-width")?.replace("px","")||1.3,fillLineDash:[0,0]},t)},"userNodeOverrides"),Ss=w((i,t)=>C(void 0,null,function*(){I.info("Creating subgraph rect for ",t.id,t);let e=F(),{themeVariables:r,handDrawnSeed:s}=e,{clusterBkg:n,clusterBorder:o}=r,{labelStyles:a,nodeStyles:c,borderStyles:l,backgroundStyles:h}=N(t),g=i.insert("g").attr("class","cluster "+t.cssClasses).attr("id",t.id).attr("data-look",t.look),f=rt(e.flowchart.htmlLabels),p=g.insert("g").attr("class","cluster-label "),u=yield At(p,t.label,{style:t.labelStyle,useHtmlLabels:f,isNode:!0}),y=u.getBBox();if(rt(e.flowchart.htmlLabels)){let D=u.children[0],M=J(u);y=D.getBoundingClientRect(),M.attr("width",y.width),M.attr("height",y.height)}let x=t.width<=y.width+t.padding?y.width+t.padding:t.width;t.width<=y.width+t.padding?t.diff=(x-t.width)/2-t.padding:t.diff=-t.padding;let d=t.height,b=t.x-x/2,m=t.y-d/2;I.trace("Data ",t,JSON.stringify(t));let S;if(t.look==="handDrawn"){let D=k.svg(g),M=A(t,{roughness:.7,fill:n,stroke:o,fillWeight:3,seed:s}),R=D.path(xt(b,m,x,d,0),M);S=g.insert(()=>(I.debug("Rough node insert CXC",R),R),":first-child"),S.select("path:nth-child(2)").attr("style",l.join(";")),S.select("path").attr("style",h.join(";").replace("fill","stroke"))}else S=g.insert("rect",":first-child"),S.attr("style",c).attr("rx",t.rx).attr("ry",t.ry).attr("x",b).attr("y",m).attr("width",x).attr("height",d);let{subGraphTitleTopMargin:v}=ta(e);if(p.attr("transform",`translate(${t.x-y.width/2}, ${t.y-t.height/2+v})`),a){let D=p.select("span");D&&D.attr("style",a)}let $=S.node().getBBox();return t.offsetX=0,t.width=$.width,t.height=$.height,t.offsetY=y.height-t.padding/2,t.intersect=function(D){return Rt(t,D)},{cluster:g,labelBBox:y}}),"rect"),qs=w((i,t)=>{let e=i.insert("g").attr("class","note-cluster").attr("id",t.id),r=e.insert("rect",":first-child"),s=0*t.padding,n=s/2;r.attr("rx",t.rx).attr("ry",t.ry).attr("x",t.x-t.width/2-n).attr("y",t.y-t.height/2-n).attr("width",t.width+s).attr("height",t.height+s).attr("fill","none");let o=r.node().getBBox();return t.width=o.width,t.height=o.height,t.intersect=function(a){return Rt(t,a)},{cluster:e,labelBBox:{width:0,height:0}}},"noteGroup"),Gs=w((i,t)=>C(void 0,null,function*(){let e=F(),{themeVariables:r,handDrawnSeed:s}=e,{altBackground:n,compositeBackground:o,compositeTitleBackground:a,nodeBorder:c}=r,l=i.insert("g").attr("class",t.cssClasses).attr("id",t.id).attr("data-id",t.id).attr("data-look",t.look),h=l.insert("g",":first-child"),g=l.insert("g").attr("class","cluster-label"),f=l.append("rect"),p=g.node().appendChild(yield gt(t.label,t.labelStyle,void 0,!0)),u=p.getBBox();if(rt(e.flowchart.htmlLabels)){let R=p.children[0],E=J(p);u=R.getBoundingClientRect(),E.attr("width",u.width),E.attr("height",u.height)}let y=0*t.padding,x=y/2,d=(t.width<=u.width+t.padding?u.width+t.padding:t.width)+y;t.width<=u.width+t.padding?t.diff=(d-t.width)/2-t.padding:t.diff=-t.padding;let b=t.height+y,m=t.height+y-u.height-6,S=t.x-d/2,v=t.y-b/2;t.width=d;let $=t.y-t.height/2-x+u.height+2,D;if(t.look==="handDrawn"){let R=t.cssClasses.includes("statediagram-cluster-alt"),E=k.svg(l),Z=t.rx||t.ry?E.path(xt(S,v,d,b,10),{roughness:.7,fill:a,fillStyle:"solid",stroke:c,seed:s}):E.rectangle(S,v,d,b,{seed:s});D=l.insert(()=>Z,":first-child");let V=E.rectangle(S,$,d,m,{fill:R?n:o,fillStyle:R?"hachure":"solid",stroke:c,seed:s});D=l.insert(()=>Z,":first-child"),f=l.insert(()=>V)}else D=h.insert("rect",":first-child"),D.attr("class","outer").attr("x",S).attr("y",v).attr("width",d).attr("height",b).attr("data-look",t.look),f.attr("class","inner").attr("x",S).attr("y",$).attr("width",d).attr("height",m);g.attr("transform",`translate(${t.x-u.width/2}, ${v+1-(rt(e.flowchart.htmlLabels)?0:3)})`);let M=D.node().getBBox();return t.height=M.height,t.offsetX=0,t.offsetY=u.height-t.padding/2,t.labelBBox=u,t.intersect=function(R){return Rt(t,R)},{cluster:l,labelBBox:u}}),"roundedWithTitle"),Zs=w((i,t)=>{let e=F(),{themeVariables:r,handDrawnSeed:s}=e,{nodeBorder:n}=r,o=i.insert("g").attr("class",t.cssClasses).attr("id",t.id).attr("data-look",t.look),a=o.insert("g",":first-child"),c=0*t.padding,l=t.width+c;t.diff=-t.padding;let h=t.height+c,g=t.x-l/2,f=t.y-h/2;t.width=l;let p;if(t.look==="handDrawn"){let x=k.svg(o).rectangle(g,f,l,h,{fill:"lightgrey",roughness:.5,strokeLineDash:[5],stroke:n,seed:s});p=o.insert(()=>x,":first-child")}else p=a.insert("rect",":first-child"),p.attr("class","divider").attr("x",g).attr("y",f).attr("width",l).attr("height",h).attr("data-look",t.look);let u=p.node().getBBox();return t.height=u.height,t.offsetX=0,t.offsetY=0,t.intersect=function(y){return Rt(t,y)},{cluster:o,labelBBox:{}}},"divider"),Fs=Ss,Vs={rect:Ss,squareRect:Fs,roundedWithTitle:Gs,noteGroup:qs,divider:Zs},vs=new Map,Ve=w((i,t)=>C(void 0,null,function*(){let e=t.shape||"rect",r=yield Vs[e](i,t);return vs.set(t.id,r),r}),"insertCluster"),Qe=w(()=>{vs=new Map},"clear"),Qs=w((i,t,e,r,s)=>{t.arrowTypeStart&&os(i,"start",t.arrowTypeStart,e,r,s),t.arrowTypeEnd&&os(i,"end",t.arrowTypeEnd,e,r,s)},"addEdgeMarkers"),Us={arrow_cross:"cross",arrow_point:"point",arrow_barb:"barb",arrow_circle:"circle",aggregation:"aggregation",extension:"extension",composition:"composition",dependency:"dependency",lollipop:"lollipop"},os=w((i,t,e,r,s,n)=>{let o=Us[e];if(!o){I.warn(`Unknown arrow type: ${e}`);return}let a=t==="start"?"Start":"End";i.attr(`marker-${t}`,`url(${r}#${s}_${n}-${o}${a})`)},"addEdgeMarker"),Kt=new Map,U=new Map,Ke=w(()=>{Kt.clear(),U.clear()},"clear"),Mt=w(i=>i?i.reduce((e,r)=>e+";"+r,""):"","getLabelStyles"),tr=w((i,t)=>C(void 0,null,function*(){let e=rt(F().flowchart.htmlLabels),r=yield At(i,t.label,{style:Mt(t.labelStyle),useHtmlLabels:e,addSvgBackground:!0,isNode:!1});I.info("abc82",t,t.labelType);let s=i.insert("g").attr("class","edgeLabel"),n=s.insert("g").attr("class","label");n.node().appendChild(r);let o=r.getBBox();if(e){let c=r.children[0],l=J(r);o=c.getBoundingClientRect(),l.attr("width",o.width),l.attr("height",o.height)}n.attr("transform","translate("+-o.width/2+", "+-o.height/2+")"),Kt.set(t.id,s),t.width=o.width,t.height=o.height;let a;if(t.startLabelLeft){let c=yield gt(t.startLabelLeft,Mt(t.labelStyle)),l=i.insert("g").attr("class","edgeTerminals"),h=l.insert("g").attr("class","inner");a=h.node().appendChild(c);let g=c.getBBox();h.attr("transform","translate("+-g.width/2+", "+-g.height/2+")"),U.get(t.id)||U.set(t.id,{}),U.get(t.id).startLeft=l,Ct(a,t.startLabelLeft)}if(t.startLabelRight){let c=yield gt(t.startLabelRight,Mt(t.labelStyle)),l=i.insert("g").attr("class","edgeTerminals"),h=l.insert("g").attr("class","inner");a=l.node().appendChild(c),h.node().appendChild(c);let g=c.getBBox();h.attr("transform","translate("+-g.width/2+", "+-g.height/2+")"),U.get(t.id)||U.set(t.id,{}),U.get(t.id).startRight=l,Ct(a,t.startLabelRight)}if(t.endLabelLeft){let c=yield gt(t.endLabelLeft,Mt(t.labelStyle)),l=i.insert("g").attr("class","edgeTerminals"),h=l.insert("g").attr("class","inner");a=h.node().appendChild(c);let g=c.getBBox();h.attr("transform","translate("+-g.width/2+", "+-g.height/2+")"),l.node().appendChild(c),U.get(t.id)||U.set(t.id,{}),U.get(t.id).endLeft=l,Ct(a,t.endLabelLeft)}if(t.endLabelRight){let c=yield gt(t.endLabelRight,Mt(t.labelStyle)),l=i.insert("g").attr("class","edgeTerminals"),h=l.insert("g").attr("class","inner");a=h.node().appendChild(c);let g=c.getBBox();h.attr("transform","translate("+-g.width/2+", "+-g.height/2+")"),l.node().appendChild(c),U.get(t.id)||U.set(t.id,{}),U.get(t.id).endRight=l,Ct(a,t.endLabelRight)}return r}),"insertEdgeLabel");function Ct(i,t){F().flowchart.htmlLabels&&i&&(i.style.width=t.length*9+"px",i.style.height="12px")}w(Ct,"setTerminalWidth");var ar=w((i,t)=>{I.debug("Moving label abc88 ",i.id,i.label,Kt.get(i.id),t);let e=t.updatedPath?t.updatedPath:t.originalPath,r=F(),{subGraphTitleTotalMargin:s}=ta(r);if(i.label){let n=Kt.get(i.id),o=i.x,a=i.y;if(e){let c=ft.calcLabelPosition(e);I.debug("Moving label "+i.label+" from (",o,",",a,") to (",c.x,",",c.y,") abc88"),t.updatedPath&&(o=c.x,a=c.y)}n.attr("transform",`translate(${o}, ${a+s/2})`)}if(i.startLabelLeft){let n=U.get(i.id).startLeft,o=i.x,a=i.y;if(e){let c=ft.calcTerminalLabelPosition(i.arrowTypeStart?10:0,"start_left",e);o=c.x,a=c.y}n.attr("transform",`translate(${o}, ${a})`)}if(i.startLabelRight){let n=U.get(i.id).startRight,o=i.x,a=i.y;if(e){let c=ft.calcTerminalLabelPosition(i.arrowTypeStart?10:0,"start_right",e);o=c.x,a=c.y}n.attr("transform",`translate(${o}, ${a})`)}if(i.endLabelLeft){let n=U.get(i.id).endLeft,o=i.x,a=i.y;if(e){let c=ft.calcTerminalLabelPosition(i.arrowTypeEnd?10:0,"end_left",e);o=c.x,a=c.y}n.attr("transform",`translate(${o}, ${a})`)}if(i.endLabelRight){let n=U.get(i.id).endRight,o=i.x,a=i.y;if(e){let c=ft.calcTerminalLabelPosition(i.arrowTypeEnd?10:0,"end_right",e);o=c.x,a=c.y}n.attr("transform",`translate(${o}, ${a})`)}},"positionEdgeLabel"),Js=w((i,t)=>{let e=i.x,r=i.y,s=Math.abs(t.x-e),n=Math.abs(t.y-r),o=i.width/2,a=i.height/2;return s>=o||n>=a},"outsideNode"),Ks=w((i,t,e)=>{I.debug(`intersection calc abc89:
  outsidePoint: ${JSON.stringify(t)}
  insidePoint : ${JSON.stringify(e)}
  node        : x:${i.x} y:${i.y} w:${i.width} h:${i.height}`);let r=i.x,s=i.y,n=Math.abs(r-e.x),o=i.width/2,a=e.x<t.x?o-n:o+n,c=i.height/2,l=Math.abs(t.y-e.y),h=Math.abs(t.x-e.x);if(Math.abs(s-t.y)*o>Math.abs(r-t.x)*c){let g=e.y<t.y?t.y-c-s:s-c-t.y;a=h*g/l;let f={x:e.x<t.x?e.x+a:e.x-h+a,y:e.y<t.y?e.y+l-g:e.y-l+g};return a===0&&(f.x=t.x,f.y=t.y),h===0&&(f.x=t.x),l===0&&(f.y=t.y),I.debug(`abc89 top/bottom calc, Q ${l}, q ${g}, R ${h}, r ${a}`,f),f}else{e.x<t.x?a=t.x-o-r:a=r-o-t.x;let g=l*a/h,f=e.x<t.x?e.x+h-a:e.x-h+a,p=e.y<t.y?e.y+g:e.y-g;return I.debug(`sides calc abc89, Q ${l}, q ${g}, R ${h}, r ${a}`,{_x:f,_y:p}),a===0&&(f=t.x,p=t.y),h===0&&(f=t.x),l===0&&(p=t.y),{x:f,y:p}}},"intersection"),hs=w((i,t)=>{I.warn("abc88 cutPathAtIntersect",i,t);let e=[],r=i[0],s=!1;return i.forEach(n=>{if(I.info("abc88 checking point",n,t),!Js(t,n)&&!s){let o=Ks(t,r,n);I.debug("abc88 inside",n,r,o),I.debug("abc88 intersection",o,t);let a=!1;e.forEach(c=>{a=a||c.x===o.x&&c.y===o.y}),e.some(c=>c.x===o.x&&c.y===o.y)?I.warn("abc88 no intersect",o,e):e.push(o),s=!0}else I.warn("abc88 outside",n,r),r=n,s||e.push(n)}),I.debug("returning points",e),e},"cutPathAtIntersect");function Ms(i){let t=[],e=[];for(let r=1;r<i.length-1;r++){let s=i[r-1],n=i[r],o=i[r+1];(s.x===n.x&&n.y===o.y&&Math.abs(n.x-o.x)>5&&Math.abs(n.y-s.y)>5||s.y===n.y&&n.x===o.x&&Math.abs(n.x-s.x)>5&&Math.abs(n.y-o.y)>5)&&(t.push(n),e.push(r))}return{cornerPoints:t,cornerPointPositions:e}}w(Ms,"extractCornerPoints");var ps=w(function(i,t,e){let r=t.x-i.x,s=t.y-i.y,n=Math.sqrt(r*r+s*s),o=e/n;return{x:t.x-o*r,y:t.y-o*s}},"findAdjacentPoint"),te=w(function(i){let{cornerPointPositions:t}=Ms(i),e=[];for(let r=0;r<i.length;r++)if(t.includes(r)){let s=i[r-1],n=i[r+1],o=i[r],a=ps(s,o,5),c=ps(n,o,5),l=c.x-a.x,h=c.y-a.y;e.push(a);let g=Math.sqrt(2)*2,f={x:o.x,y:o.y};if(Math.abs(n.x-s.x)>10&&Math.abs(n.y-s.y)>=10){I.debug("Corner point fixing",Math.abs(n.x-s.x),Math.abs(n.y-s.y));let p=5;o.x===a.x?f={x:l<0?a.x-p+g:a.x+p-g,y:h<0?a.y-g:a.y+g}:f={x:l<0?a.x-g:a.x+g,y:h<0?a.y-p+g:a.y+p-g}}else I.debug("Corner point skipping fixing",Math.abs(n.x-s.x),Math.abs(n.y-s.y));e.push(f,c)}else e.push(i[r]);return e},"fixCorners"),sr=w(function(i,t,e,r,s,n,o){let{handDrawnSeed:a}=F(),c=t.points,l=!1,h=s;var g=n;g.intersect&&h.intersect&&(c=c.slice(1,t.points.length-1),c.unshift(h.intersect(c[0])),I.debug("Last point APA12",t.start,"-->",t.end,c[c.length-1],g,g.intersect(c[c.length-1])),c.push(g.intersect(c[c.length-1]))),t.toCluster&&(I.info("to cluster abc88",e.get(t.toCluster)),c=hs(t.points,e.get(t.toCluster).node),l=!0),t.fromCluster&&(I.debug("from cluster abc88",e.get(t.fromCluster),JSON.stringify(c,null,2)),c=hs(c.reverse(),e.get(t.fromCluster).node).reverse(),l=!0);let f=c.filter(M=>!Number.isNaN(M.y));f=te(f);let p=f[f.length-1];if(f.length>1){p=f[f.length-1];let M=f[f.length-2],R=(p.x-M.x)/2,E=(p.y-M.y)/2,Z={x:M.x+R,y:M.y+E};f.splice(-1,0,Z)}let u=Fa;t.curve&&(u=t.curve);let{x:y,y:x}=Ga(t),d=Za().x(y).y(x).curve(u),b;switch(t.thickness){case"normal":b="edge-thickness-normal";break;case"thick":b="edge-thickness-thick";break;case"invisible":b="edge-thickness-invisible";break;default:b="edge-thickness-normal"}switch(t.pattern){case"solid":b+=" edge-pattern-solid";break;case"dotted":b+=" edge-pattern-dotted";break;case"dashed":b+=" edge-pattern-dashed";break;default:b+=" edge-pattern-solid"}let m,S=d(f),v=Array.isArray(t.style)?t.style:[t.style];if(t.look==="handDrawn"){let M=k.svg(i);Object.assign([],f);let R=M.path(S,{roughness:.3,seed:a});b+=" transition",m=J(R).select("path").attr("id",t.id).attr("class"," "+b+(t.classes?" "+t.classes:"")).attr("style",v?v.reduce((Z,V)=>Z+";"+V,""):"");let E=m.attr("d");m.attr("d",E),i.node().appendChild(m.node())}else m=i.append("path").attr("d",S).attr("id",t.id).attr("class"," "+b+(t.classes?" "+t.classes:"")).attr("style",v?v.reduce((M,R)=>M+";"+R,""):"");let $="";(F().flowchart.arrowMarkerAbsolute||F().state.arrowMarkerAbsolute)&&($=window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search,$=$.replace(/\(/g,"\\(").replace(/\)/g,"\\)")),I.info("arrowTypeStart",t.arrowTypeStart),I.info("arrowTypeEnd",t.arrowTypeEnd),Qs(m,t,$,o,r);let D={};return l&&(D.updatedPath=c),D.originalPath=t.points,D},"insertEdge"),ae=w((i,t,e,r)=>{t.forEach(s=>{pe[s](i,e,r)})},"insertMarkers"),se=w((i,t,e)=>{I.trace("Making markers for ",e),i.append("defs").append("marker").attr("id",e+"_"+t+"-extensionStart").attr("class","marker extension "+t).attr("refX",18).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 1,7 L18,13 V 1 Z"),i.append("defs").append("marker").attr("id",e+"_"+t+"-extensionEnd").attr("class","marker extension "+t).attr("refX",1).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 1,1 V 13 L18,7 Z")},"extension"),ee=w((i,t,e)=>{i.append("defs").append("marker").attr("id",e+"_"+t+"-compositionStart").attr("class","marker composition "+t).attr("refX",18).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),i.append("defs").append("marker").attr("id",e+"_"+t+"-compositionEnd").attr("class","marker composition "+t).attr("refX",1).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z")},"composition"),re=w((i,t,e)=>{i.append("defs").append("marker").attr("id",e+"_"+t+"-aggregationStart").attr("class","marker aggregation "+t).attr("refX",18).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),i.append("defs").append("marker").attr("id",e+"_"+t+"-aggregationEnd").attr("class","marker aggregation "+t).attr("refX",1).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z")},"aggregation"),ne=w((i,t,e)=>{i.append("defs").append("marker").attr("id",e+"_"+t+"-dependencyStart").attr("class","marker dependency "+t).attr("refX",6).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 5,7 L9,13 L1,7 L9,1 Z"),i.append("defs").append("marker").attr("id",e+"_"+t+"-dependencyEnd").attr("class","marker dependency "+t).attr("refX",13).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L14,7 L9,1 Z")},"dependency"),ie=w((i,t,e)=>{i.append("defs").append("marker").attr("id",e+"_"+t+"-lollipopStart").attr("class","marker lollipop "+t).attr("refX",13).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("circle").attr("stroke","black").attr("fill","transparent").attr("cx",7).attr("cy",7).attr("r",6),i.append("defs").append("marker").attr("id",e+"_"+t+"-lollipopEnd").attr("class","marker lollipop "+t).attr("refX",1).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("circle").attr("stroke","black").attr("fill","transparent").attr("cx",7).attr("cy",7).attr("r",6)},"lollipop"),le=w((i,t,e)=>{i.append("marker").attr("id",e+"_"+t+"-pointEnd").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",5).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",8).attr("markerHeight",8).attr("orient","auto").append("path").attr("d","M 0 0 L 10 5 L 0 10 z").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0"),i.append("marker").attr("id",e+"_"+t+"-pointStart").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",4.5).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",8).attr("markerHeight",8).attr("orient","auto").append("path").attr("d","M 0 5 L 10 10 L 10 0 z").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0")},"point"),ce=w((i,t,e)=>{i.append("marker").attr("id",e+"_"+t+"-circleEnd").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",11).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("circle").attr("cx","5").attr("cy","5").attr("r","5").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0"),i.append("marker").attr("id",e+"_"+t+"-circleStart").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",-1).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("circle").attr("cx","5").attr("cy","5").attr("r","5").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0")},"circle"),oe=w((i,t,e)=>{i.append("marker").attr("id",e+"_"+t+"-crossEnd").attr("class","marker cross "+t).attr("viewBox","0 0 11 11").attr("refX",12).attr("refY",5.2).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("path").attr("d","M 1,1 l 9,9 M 10,1 l -9,9").attr("class","arrowMarkerPath").style("stroke-width",2).style("stroke-dasharray","1,0"),i.append("marker").attr("id",e+"_"+t+"-crossStart").attr("class","marker cross "+t).attr("viewBox","0 0 11 11").attr("refX",-1).attr("refY",5.2).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("path").attr("d","M 1,1 l 9,9 M 10,1 l -9,9").attr("class","arrowMarkerPath").style("stroke-width",2).style("stroke-dasharray","1,0")},"cross"),he=w((i,t,e)=>{i.append("defs").append("marker").attr("id",e+"_"+t+"-barbEnd").attr("refX",19).attr("refY",7).attr("markerWidth",20).attr("markerHeight",14).attr("markerUnits","userSpaceOnUse").attr("orient","auto").append("path").attr("d","M 19,7 L9,13 L14,7 L9,1 Z")},"barb"),pe={extension:se,composition:ee,aggregation:re,dependency:ne,lollipop:ie,point:le,circle:ce,cross:oe,barb:he},er=ae,z=w((i,t,e)=>C(void 0,null,function*(){let r,s=t.useHtmlLabels||rt(F().flowchart.htmlLabels);e?r=e:r="node default";let n=i.insert("g").attr("class",r).attr("id",t.domId||t.id),o=n.insert("g").attr("class","label").attr("style",t.labelStyle),a;t.label===void 0?a="":a=typeof t.label=="string"?t.label:t.label[0];let c;c=yield At(o,ja(aa(a),F()),{useHtmlLabels:s,width:t.width||F().flowchart.wrappingWidth,cssClasses:"markdown-node-label",style:t.labelStyle,addSvgBackground:!!t.icon||!!t.img});let l=c.getBBox(),h=t.padding/2;if(rt(F().flowchart.htmlLabels)){let g=c.children[0],f=J(c),p=g.getElementsByTagName("img");if(p){let u=a.replace(/<img[^>]*>/g,"").trim()==="";yield Promise.all([...p].map(y=>new Promise(x=>{function d(){if(y.style.display="flex",y.style.flexDirection="column",u){let b=F().fontSize?F().fontSize:window.getComputedStyle(document.body).fontSize,S=parseInt(b,10)*5+"px";y.style.minWidth=S,y.style.maxWidth=S}else y.style.width="100%";x(y)}w(d,"setupImage"),setTimeout(()=>{y.complete&&d()}),y.addEventListener("error",d),y.addEventListener("load",d)})))}l=g.getBoundingClientRect(),f.attr("width",l.width),f.attr("height",l.height)}return s?o.attr("transform","translate("+-l.width/2+", "+-l.height/2+")"):o.attr("transform","translate(0, "+-l.height/2+")"),t.centerLabel&&o.attr("transform","translate("+-l.width/2+", "+-l.height/2+")"),o.insert("rect",":first-child"),{shapeSvg:n,bbox:l,halfPadding:h,label:o}}),"labelHelper"),W=w((i,t)=>{let e=t.node().getBBox();i.width=e.width,i.height=e.height},"updateNodeBounds"),j=w((i,t)=>(i.look==="handDrawn"?"rough-node":"node")+" "+i.cssClasses+" "+(t||""),"getNodeClasses");function G(i){let t=i.map((e,r)=>`${r===0?"M":"L"}${e.x},${e.y}`);return t.push("Z"),t.join(" ")}w(G,"createPathFromPoints");function ot(i,t,e,r,s,n){let o=[],c=e-i,l=r-t,h=c/n,g=2*Math.PI/h,f=t+l/2;for(let p=0;p<=50;p++){let u=p/50,y=i+u*c,x=f+s*Math.sin(g*(y-i));o.push({x:y,y:x})}return o}w(ot,"generateFullSineWavePoints");function Ia(i,t,e,r,s,n){let o=[],a=s*Math.PI/180,h=(n*Math.PI/180-a)/(r-1);for(let g=0;g<r;g++){let f=a+g*h,p=i+e*Math.cos(f),u=t+e*Math.sin(f);o.push({x:-p,y:-u})}return o}w(Ia,"generateCirclePoints");function $s(i,t){return i.intersect(t)}w($s,"intersectNode");var ge=$s;function Ps(i,t,e,r){var s=i.x,n=i.y,o=s-r.x,a=n-r.y,c=Math.sqrt(t*t*a*a+e*e*o*o),l=Math.abs(t*e*o/c);r.x<s&&(l=-l);var h=Math.abs(t*e*a/c);return r.y<n&&(h=-h),{x:s+l,y:n+h}}w(Ps,"intersectEllipse");var Ds=Ps;function Ls(i,t,e){return Ds(i,t,t,e)}w(Ls,"intersectCircle");var fe=Ls;function Cs(i,t,e,r){var s,n,o,a,c,l,h,g,f,p,u,y,x,d,b;if(s=t.y-i.y,o=i.x-t.x,c=t.x*i.y-i.x*t.y,f=s*e.x+o*e.y+c,p=s*r.x+o*r.y+c,!(f!==0&&p!==0&&_a(f,p))&&(n=r.y-e.y,a=e.x-r.x,l=r.x*e.y-e.x*r.y,h=n*i.x+a*i.y+l,g=n*t.x+a*t.y+l,!(h!==0&&g!==0&&_a(h,g))&&(u=s*a-n*o,u!==0)))return y=Math.abs(u/2),x=o*l-a*c,d=x<0?(x-y)/u:(x+y)/u,x=n*c-s*l,b=x<0?(x-y)/u:(x+y)/u,{x:d,y:b}}w(Cs,"intersectLine");function _a(i,t){return i*t>0}w(_a,"sameSign");var ue=Cs;function Rs(i,t,e){let r=i.x,s=i.y,n=[],o=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY;typeof t.forEach=="function"?t.forEach(function(h){o=Math.min(o,h.x),a=Math.min(a,h.y)}):(o=Math.min(o,t.x),a=Math.min(a,t.y));let c=r-i.width/2-o,l=s-i.height/2-a;for(let h=0;h<t.length;h++){let g=t[h],f=t[h<t.length-1?h+1:0],p=ue(i,e,{x:c+g.x,y:l+g.y},{x:c+f.x,y:l+f.y});p&&n.push(p)}return n.length?(n.length>1&&n.sort(function(h,g){let f=h.x-e.x,p=h.y-e.y,u=Math.sqrt(f*f+p*p),y=g.x-e.x,x=g.y-e.y,d=Math.sqrt(y*y+x*x);return u<d?-1:u===d?0:1}),n[0]):i}w(Rs,"intersectPolygon");var ye=Rs,L={node:ge,circle:fe,ellipse:Ds,polygon:ye,rect:Rt},za=w((i,t,e)=>C(void 0,null,function*(){let{labelStyles:r,nodeStyles:s}=N(t);t.labelStyle=r;let{shapeSvg:n,bbox:o}=yield z(i,t,j(t)),a=Math.max(o.width+e.labelPaddingX*2,t?.width||0),c=Math.max(o.height+e.labelPaddingY*2,t?.height||0),l=-a/2,h=-c/2,g,{rx:f,ry:p}=t,{cssStyles:u}=t;if(e?.rx&&e.ry&&(f=e.rx,p=e.ry),t.look==="handDrawn"){let y=k.svg(n),x=A(t,{}),d=f||p?y.path(xt(l,h,a,c,f||0),x):y.rectangle(l,h,a,c,x);g=n.insert(()=>d,":first-child"),g.attr("class","basic label-container").attr("style",u)}else g=n.insert("rect",":first-child"),g.attr("class","basic label-container").attr("style",s).attr("rx",f).attr("ry",p).attr("x",l).attr("y",h).attr("width",a).attr("height",c);return W(t,g),t.intersect=function(y){return L.rect(t,y)},n}),"drawRect"),de=w((i,t)=>C(void 0,null,function*(){return za(i,t,{rx:5,ry:5,classes:"flowchart-node"})}),"state"),wa=w((i,t)=>C(void 0,null,function*(){let e={rx:5,ry:5,classes:"",labelPaddingX:(t?.padding||0)*1,labelPaddingY:(t?.padding||0)*1};return za(i,t,e)}),"roundedRect"),$t=w((i,t)=>C(void 0,null,function*(){let e={rx:0,ry:0,classes:"",labelPaddingX:(t?.padding||0)*2,labelPaddingY:(t?.padding||0)*1};return za(i,t,e)}),"squareRect"),zt=w((i,t,{config:{themeVariables:e}})=>{let{lineColor:r}=e,s=i.insert("g").attr("class","node default").attr("id",t.domId||t.id),n;if(t.look==="handDrawn"){let a=k.svg(s).circle(0,0,14,Xs(r));n=s.insert(()=>a)}else n=s.insert("circle",":first-child");return n.attr("class","state-start").attr("r",7).attr("width",14).attr("height",14),W(t,n),t.intersect=function(o){return L.circle(t,7,o)},s},"stateStart"),jt=w((i,t,{config:{themeVariables:e}})=>{let{labelStyles:r,nodeStyles:s}=N(t);t.labelStyle=r;let{cssStyles:n}=t,{lineColor:o,stateBorder:a,nodeBorder:c}=e,l=i.insert("g").attr("class","node default").attr("id",t.domId||t.id),h=k.svg(l),g=A(t,{});t.look!=="handDrawn"&&(g.roughness=0,g.fillStyle="solid");let f=h.circle(0,0,14,et(K({},g),{stroke:o,strokeWidth:2})),p=a??c,u=h.circle(0,0,5,et(K({},g),{fill:p,stroke:p,strokeWidth:2,fillStyle:"solid"})),y=l.insert(()=>f,":first-child");return y.insert(()=>u),n&&y.selectAll("path").attr("style",n),s&&y.selectAll("path").attr("style",s),W(t,y),t.intersect=function(x){return L.circle(t,7,x)},l},"stateEnd"),ma=w((i,t,{dir:e,config:{state:r,themeVariables:s}})=>{let{nodeStyles:n}=N(t);t.label="";let o=i.insert("g").attr("class",j(t)).attr("id",t.domId??t.id),{cssStyles:a}=t,c=Math.max(70,t?.width??0),l=Math.max(10,t?.height??0);e==="LR"&&(c=Math.max(10,t?.width??0),l=Math.max(70,t?.height??0));let h=-1*c/2,g=-1*l/2,f=k.svg(o),p=A(t,{stroke:s.lineColor,fill:s.lineColor});t.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");let u=f.rectangle(h,g,c,l,p),y=o.insert(()=>u,":first-child");a&&t.look!=="handDrawn"&&y.selectAll("path").attr("style",a),n&&t.look!=="handDrawn"&&y.selectAll("path").attr("style",n),W(t,y);let x=r?.padding??0;return t.width&&t.height&&(t.width+=x/2||0,t.height+=x/2||0),t.intersect=function(d){return L.rect(t,d)},o},"forkJoin"),xe=w((i,t)=>{let{nodeStyles:e}=N(t);t.label="";let r=i.insert("g").attr("class",j(t)).attr("id",t.domId??t.id),{cssStyles:s}=t,n=Math.max(28,t.width??0),o=[{x:0,y:n/2},{x:n/2,y:0},{x:0,y:-n/2},{x:-n/2,y:0}],a=k.svg(r),c=A(t,{});t.look!=="handDrawn"&&(c.roughness=0,c.fillStyle="solid");let l=G(o),h=a.path(l,c),g=r.insert(()=>h,":first-child");return s&&t.look!=="handDrawn"&&g.selectAll("path").attr("style",s),e&&t.look!=="handDrawn"&&g.selectAll("path").attr("style",e),t.width=28,t.height=28,t.intersect=function(f){return L.polygon(t,o,f)},r},"choice"),be=w((r,s,n)=>C(void 0,[r,s,n],function*(i,t,{config:{themeVariables:e}}){let{labelStyles:o,nodeStyles:a}=N(t);t.labelStyle=o;let{shapeSvg:c,bbox:l}=yield z(i,t,j(t)),h=Math.max(l.width+(t.padding??0)*2,t?.width??0),g=Math.max(l.height+(t.padding??0)*2,t?.height??0),f=-h/2,p=-g/2,{cssStyles:u}=t;t.useHtmlLabels||(t.centerLabel=!0);let x=k.svg(c),d=A(t,{fill:e.noteBkgColor,stroke:e.noteBorderColor});t.look!=="handDrawn"&&(d.roughness=0,d.fillStyle="solid");let b=x.rectangle(f,p,h,g,d),m=c.insert(()=>b,":first-child");return m.attr("class","basic label-container"),u&&t.look!=="handDrawn"&&m.selectAll("path").attr("style",u),a&&t.look!=="handDrawn"&&m.selectAll("path").attr("style",a),W(t,m),t.intersect=function(S){return L.rect(t,S)},c}),"note"),ka=w((i,t)=>C(void 0,null,function*(){let{labelStyles:e,nodeStyles:r}=N(t);t.labelStyle=e;let{shapeSvg:s,bbox:n}=yield z(i,t,j(t)),o=n.height+t.padding,a=n.width+o/4+t.padding,c,{cssStyles:l}=t;if(t.look==="handDrawn"){let h=k.svg(s),g=A(t,{}),f=xt(-a/2,-o/2,a,o,o/2),p=h.path(f,g);c=s.insert(()=>p,":first-child"),c.attr("class","basic label-container").attr("style",l)}else c=s.insert("rect",":first-child"),c.attr("class","basic label-container").attr("style",r).attr("rx",o/2).attr("ry",o/2).attr("x",-a/2).attr("y",-o/2).attr("width",a).attr("height",o);return W(t,c),t.intersect=function(h){return L.rect(t,h)},s}),"stadium"),we=w((i,t)=>C(void 0,null,function*(){let{labelStyles:e,nodeStyles:r}=N(t);t.labelStyle=e;let s;t.cssClasses?s="node "+t.cssClasses:s="node default";let n=i.insert("g").attr("class",s).attr("id",t.domId||t.id),o=n.insert("g"),a=n.insert("g").attr("class","label").attr("style",r),c=t.description,l=t.label,h=a.node().appendChild(yield gt(l,t.labelStyle,!0,!0)),g={width:0,height:0};if(rt(F()?.flowchart?.htmlLabels)){let M=h.children[0],R=J(h);g=M.getBoundingClientRect(),R.attr("width",g.width),R.attr("height",g.height)}I.info("Text 2",c);let f=c||[],p=h.getBBox(),u=a.node().appendChild(yield gt(f.join?f.join("<br/>"):f,t.labelStyle,!0,!0)),y=u.children[0],x=J(u);g=y.getBoundingClientRect(),x.attr("width",g.width),x.attr("height",g.height);let d=(t.padding||0)/2;J(u).attr("transform","translate( "+(g.width>p.width?0:(p.width-g.width)/2)+", "+(p.height+d+5)+")"),J(h).attr("transform","translate( "+(g.width<p.width?0:-(p.width-g.width)/2)+", 0)"),g=a.node().getBBox(),a.attr("transform","translate("+-g.width/2+", "+(-g.height/2-d+3)+")");let b=g.width+(t.padding||0),m=g.height+(t.padding||0),S=-g.width/2-d,v=-g.height/2-d,$,D;if(t.look==="handDrawn"){let M=k.svg(n),R=A(t,{}),E=M.path(xt(S,v,b,m,t.rx||0),R),Z=M.line(-g.width/2-d,-g.height/2-d+p.height+d,g.width/2+d,-g.height/2-d+p.height+d,R);D=n.insert(()=>(I.debug("Rough node insert CXC",E),Z),":first-child"),$=n.insert(()=>(I.debug("Rough node insert CXC",E),E),":first-child")}else $=o.insert("rect",":first-child"),D=o.insert("line"),$.attr("class","outer title-state").attr("style",r).attr("x",-g.width/2-d).attr("y",-g.height/2-d).attr("width",g.width+(t.padding||0)).attr("height",g.height+(t.padding||0)),D.attr("class","divider").attr("x1",-g.width/2-d).attr("x2",g.width/2+d).attr("y1",-g.height/2-d+p.height+d).attr("y2",-g.height/2-d+p.height+d);return W(t,$),t.intersect=function(M){return L.rect(t,M)},n}),"rectWithTitle");function lt(i,t,e,r){return i.insert("polygon",":first-child").attr("points",r.map(function(s){return s.x+","+s.y}).join(" ")).attr("class","label-container").attr("transform","translate("+-t/2+","+e/2+")")}w(lt,"insertPolygonShape");var Pt=w((i,t)=>C(void 0,null,function*(){let{labelStyles:e,nodeStyles:r}=N(t);t.labelStyle=e;let{shapeSvg:s,bbox:n}=yield z(i,t,j(t)),o=(t?.padding||0)/2,a=n.width+t.padding,c=n.height+t.padding,l=-n.width/2-o,h=-n.height/2-o,g=[{x:0,y:0},{x:a,y:0},{x:a,y:-c},{x:0,y:-c},{x:0,y:0},{x:-8,y:0},{x:a+8,y:0},{x:a+8,y:-c},{x:-8,y:-c},{x:-8,y:0}];if(t.look==="handDrawn"){let f=k.svg(s),p=A(t,{}),u=f.rectangle(l-8,h,a+16,c,p),y=f.line(l,h,l,h+c,p),x=f.line(l+a,h,l+a,h+c,p);s.insert(()=>y,":first-child"),s.insert(()=>x,":first-child");let d=s.insert(()=>u,":first-child"),{cssStyles:b}=t;d.attr("class","basic label-container").attr("style",b),W(t,d)}else{let f=lt(s,a,c,g);r&&f.attr("style",r),W(t,f)}return t.intersect=function(f){return L.polygon(t,g,f)},s}),"subroutine"),me=w((i,t,e,r,s,n)=>[`M${i},${t+n}`,`a${s},${n} 0,0,0 ${e},0`,`a${s},${n} 0,0,0 ${-e},0`,`l0,${r}`,`a${s},${n} 0,0,0 ${e},0`,`l0,${-r}`].join(" "),"createCylinderPathD"),ke=w((i,t,e,r,s,n)=>[`M${i},${t+n}`,`M${i+e},${t+n}`,`a${s},${n} 0,0,0 ${-e},0`,`l0,${r}`,`a${s},${n} 0,0,0 ${e},0`,`l0,${-r}`].join(" "),"createOuterCylinderPathD"),Se=w((i,t,e,r,s,n)=>[`M${i-e/2},${-r/2}`,`a${s},${n} 0,0,0 ${e},0`].join(" "),"createInnerCylinderPathD"),Xt=w((i,t)=>C(void 0,null,function*(){let{labelStyles:e,nodeStyles:r}=N(t);t.labelStyle=e;let{shapeSvg:s,bbox:n,label:o}=yield z(i,t,j(t)),a=Math.max(n.width+t.padding,t.width??0),c=a/2,l=c/(2.5+a/50),h=Math.max(n.height+l+t.padding,t.height??0),g,{cssStyles:f}=t;if(t.look==="handDrawn"){let p=k.svg(s),u=ke(0,0,a,h,c,l),y=Se(0,l,a,h,c,l),x=p.path(u,A(t,{})),d=p.path(y,A(t,{fill:"none"}));g=s.insert(()=>d,":first-child"),g=s.insert(()=>x,":first-child"),g.attr("class","basic label-container"),f&&g.attr("style",f)}else{let p=me(0,0,a,h,c,l);g=s.insert("path",":first-child").attr("d",p).attr("class","basic label-container").attr("style",f).attr("style",r)}return g.attr("label-offset-y",l),g.attr("transform",`translate(${-a/2}, ${-(h/2+l)})`),W(t,g),o.attr("transform",`translate(${-(n.width/2)-(n.x-(n.left??0))}, ${-(n.height/2)+(t.padding??0)/1.5-(n.y-(n.top??0))})`),t.intersect=function(p){let u=L.rect(t,p),y=u.x-(t.x??0);if(c!=0&&(Math.abs(y)<(t.width??0)/2||Math.abs(y)==(t.width??0)/2&&Math.abs(u.y-(t.y??0))>(t.height??0)/2-l)){let x=l*l*(1-y*y/(c*c));x>0&&(x=Math.sqrt(x)),x=l-x,p.y-(t.y??0)>0&&(x=-x),u.y+=x}return u},s}),"cylinder"),gs=w((i,t)=>C(void 0,null,function*(){let{labelStyles:e,nodeStyles:r}=N(t);t.labelStyle=e;let{shapeSvg:s,bbox:n,halfPadding:o}=yield z(i,t,j(t)),a=n.width/2+o,c,{cssStyles:l}=t;if(t.look==="handDrawn"){let h=k.svg(s),g=A(t,{}),f=h.circle(0,0,a*2,g);c=s.insert(()=>f,":first-child"),c.attr("class","basic label-container").attr("style",l)}else c=s.insert("circle",":first-child").attr("class","basic label-container").attr("style",r).attr("r",a).attr("cx",0).attr("cy",0);return W(t,c),t.intersect=function(h){return I.info("Circle intersect",t,a,h),L.circle(t,a,h)},s}),"circle"),Sa=w((i,t)=>C(void 0,null,function*(){let{labelStyles:e,nodeStyles:r}=N(t);t.labelStyle=e;let{shapeSvg:s,bbox:n,halfPadding:o}=yield z(i,t,j(t)),c=n.width/2+o+5,l=n.width/2+o,h,{cssStyles:g}=t;if(t.look==="handDrawn"){let f=k.svg(s),p=A(t,{roughness:.2,strokeWidth:2.5}),u=A(t,{roughness:.2,strokeWidth:1.5}),y=f.circle(0,0,c*2,p),x=f.circle(0,0,l*2,u);h=s.insert("g",":first-child"),h.attr("class",t.cssClasses).attr("style",g),h.node()?.appendChild(y),h.node()?.appendChild(x)}else{h=s.insert("g",":first-child");let f=h.insert("circle",":first-child"),p=h.insert("circle");h.attr("class","basic label-container").attr("style",r),f.attr("class","outer-circle").attr("style",r).attr("r",c).attr("cx",0).attr("cy",0),p.attr("class","inner-circle").attr("style",r).attr("r",l).attr("cx",0).attr("cy",0)}return W(t,h),t.intersect=function(f){return I.info("DoubleCircle intersect",t,c,f),L.circle(t,c,f)},s}),"doublecircle"),fs=w((i,t)=>C(void 0,null,function*(){let{labelStyles:e,nodeStyles:r}=N(t);t.labelStyle=e;let{shapeSvg:s,bbox:n,label:o}=yield z(i,t,j(t)),a=Math.max(n.width+(t.padding??0),t?.width??0),c=Math.max(n.height+(t.padding??0),t?.height??0),l=-a/2,h=-c/2,g=h/2,f=[{x:l+g,y:h},{x:l,y:0},{x:l+g,y:-h},{x:-l,y:-h},{x:-l,y:h}],{cssStyles:p}=t,u=k.svg(s),y=A(t,{});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");let x=G(f),d=u.path(x,y),b=s.insert(()=>d,":first-child");return b.attr("class","basic label-container"),p&&t.look!=="handDrawn"&&b.selectAll("path").attr("style",p),r&&t.look!=="handDrawn"&&b.selectAll("path").attr("style",r),b.attr("transform",`translate(${-g/2},0)`),o.attr("transform",`translate(${-g/2-n.width/2-(n.x-(n.left??0))}, ${-(n.height/2)-(n.y-(n.top??0))})`),W(t,b),t.intersect=function(m){return L.polygon(t,f,m)},s}),"rect_left_inv_arrow"),ve=w((i,t,e)=>[`M${i+e/2},${t}`,`L${i+e},${t-e/2}`,`L${i+e/2},${t-e}`,`L${i},${t-e/2}`,"Z"].join(" "),"createDecisionBoxPathD"),Yt=w((i,t)=>C(void 0,null,function*(){let{labelStyles:e,nodeStyles:r}=N(t);t.labelStyle=e;let{shapeSvg:s,bbox:n}=yield z(i,t,j(t)),o=n.width+t.padding,a=n.height+t.padding,c=o+a,l=[{x:c/2,y:0},{x:c,y:-c/2},{x:c/2,y:-c},{x:0,y:-c/2}],h,{cssStyles:g}=t;if(t.look==="handDrawn"){let f=k.svg(s),p=A(t,{}),u=ve(0,0,c),y=f.path(u,p);h=s.insert(()=>y,":first-child").attr("transform",`translate(${-c/2}, ${c/2})`),g&&h.attr("style",g)}else h=lt(s,c,c,l);return r&&h.attr("style",r),W(t,h),t.intersect=function(f){return I.debug(`APA12 Intersect called SPLIT
point:`,f,`
node:
`,t,`
res:`,L.polygon(t,l,f)),L.polygon(t,l,f)},s}),"question"),Me=w((i,t,e,r,s)=>[`M${i+s},${t}`,`L${i+e-s},${t}`,`L${i+e},${t-r/2}`,`L${i+e-s},${t-r}`,`L${i+s},${t-r}`,`L${i},${t-r/2}`,"Z"].join(" "),"createHexagonPathD"),va=w((i,t)=>C(void 0,null,function*(){let{labelStyles:e,nodeStyles:r}=N(t);t.labelStyle=e;let{shapeSvg:s,bbox:n}=yield z(i,t,j(t)),o=4,a=n.height+t.padding,c=a/o,l=n.width+2*c+t.padding,h=[{x:c,y:0},{x:l-c,y:0},{x:l,y:-a/2},{x:l-c,y:-a},{x:c,y:-a},{x:0,y:-a/2}],g,{cssStyles:f}=t;if(t.look==="handDrawn"){let p=k.svg(s),u=A(t,{}),y=Me(0,0,l,a,c),x=p.path(y,u);g=s.insert(()=>x,":first-child").attr("transform",`translate(${-l/2}, ${a/2})`),f&&g.attr("style",f)}else g=lt(s,l,a,h);return r&&g.attr("style",r),t.width=l,t.height=a,W(t,g),t.intersect=function(p){return L.polygon(t,h,p)},s}),"hexagon");function As(i,t){return C(this,null,function*(){let{labelStyles:e,nodeStyles:r}=N(t);t.labelStyle=e;let{shapeSvg:s,bbox:n}=yield z(i,t,j(t)),o=Math.max(n.width+t.padding,t?.width||0),a=Math.max(n.height+t.padding,t?.height||0),c=-o/2,l=-a/2,h=s.insert("rect",":first-child");return h.attr("class","text").attr("style",r).attr("rx",0).attr("ry",0).attr("x",c).attr("y",l).attr("width",o).attr("height",a),W(t,h),t.intersect=function(g){return L.rect(t,g)},s})}w(As,"text");function Jt(i,t){return C(this,null,function*(){let{labelStyles:e,nodeStyles:r}=N(t);t.labelStyle=e;let{shapeSvg:s,bbox:n}=yield z(i,t,j(t)),o=n.height+t.padding,a=12,c=n.width+t.padding+a,l=0,h=c,g=-o,f=0,p=[{x:l+a,y:g},{x:h,y:g},{x:h,y:f},{x:l,y:f},{x:l,y:g+a},{x:l+a,y:g}],u,{cssStyles:y}=t;if(t.look==="handDrawn"){let x=k.svg(s),d=A(t,{}),b=G(p),m=x.path(b,d);u=s.insert(()=>m,":first-child").attr("transform",`translate(${-c/2}, ${o/2})`),y&&u.attr("style",y)}else u=lt(s,c,o,p);return r&&u.attr("style",r),W(t,u),t.intersect=function(x){return L.polygon(t,p,x)},s})}w(Jt,"card");var Dt=w((i,t)=>C(void 0,null,function*(){let{labelStyles:e,nodeStyles:r}=N(t);t.labelStyle=e;let{shapeSvg:s,bbox:n,label:o}=yield z(i,t,j(t)),a=t?.padding??0,c=Math.max(n.width+(t.padding??0)*2,t?.width??0),l=Math.max(n.height+(t.padding??0)*2,t?.height??0),h=-n.width/2-a,g=-n.height/2-a,{cssStyles:f}=t,p=k.svg(s),u=A(t,{});t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let y=[{x:h,y:g},{x:h+c+8,y:g},{x:h+c+8,y:g+l},{x:h-8,y:g+l},{x:h-8,y:g},{x:h,y:g},{x:h,y:g+l}],x=p.polygon(y.map(b=>[b.x,b.y]),u),d=s.insert(()=>x,":first-child");return d.attr("class","basic label-container").attr("style",f),r&&t.look!=="handDrawn"&&d.selectAll("path").attr("style",r),f&&t.look!=="handDrawn"&&d.selectAll("path").attr("style",r),o.attr("transform",`translate(${-c/2+4+(t.padding??0)-(n.x-(n.left??0))},${-l/2+(t.padding??0)-(n.y-(n.top??0))})`),W(t,d),t.intersect=function(b){return L.rect(t,b)},s}),"shadedProcess"),$e=w((i,t)=>{let{labelStyles:e}=N(t);t.labelStyle=e;let r=j(t),s=r;r||(s="anchor");let n=i.insert("g").attr("class",s).attr("id",t.domId||t.id),o=1,{cssStyles:a}=t,c=k.svg(n),l=A(t,{fill:"black",stroke:"none",fillStyle:"solid"});t.look!=="handDrawn"&&(l.roughness=0);let h=c.circle(0,0,o*2,l),g=n.insert(()=>h,":first-child");return g.attr("class","anchor").attr("style",a),W(t,g),t.intersect=function(f){return I.info("Circle intersect",t,o,f),L.circle(t,o,f)},n},"anchor"),qt=w((i,t)=>C(void 0,null,function*(){let{labelStyles:e,nodeStyles:r}=N(t);t.labelStyle=e;let{shapeSvg:s,bbox:n}=yield z(i,t,j(t)),o=Math.max(n.width+(t.padding??0),t?.width??0),a=Math.max(n.height+(t.padding??0),t?.height??0),c=[{x:-3*a/6,y:0},{x:o,y:0},{x:o+3*a/6,y:-a},{x:0,y:-a}],l,{cssStyles:h}=t;if(t.look==="handDrawn"){let g=k.svg(s),f=A(t,{}),p=G(c),u=g.path(p,f);l=s.insert(()=>u,":first-child").attr("transform",`translate(${-o/2}, ${a/2})`),h&&l.attr("style",h)}else l=lt(s,o,a,c);return r&&l.attr("style",r),t.width=o,t.height=a,W(t,l),t.intersect=function(g){return L.polygon(t,c,g)},s}),"lean_right"),Gt=w((i,t)=>C(void 0,null,function*(){let{labelStyles:e,nodeStyles:r}=N(t);t.labelStyle=e;let{shapeSvg:s,bbox:n}=yield z(i,t,j(t)),o=Math.max(n.width+(t.padding??0),t?.width??0),a=Math.max(n.height+(t.padding??0),t?.height??0),c=[{x:0,y:0},{x:o+3*a/6,y:0},{x:o,y:-a},{x:-(3*a)/6,y:-a}],l,{cssStyles:h}=t;if(t.look==="handDrawn"){let g=k.svg(s),f=A(t,{}),p=G(c),u=g.path(p,f);l=s.insert(()=>u,":first-child").attr("transform",`translate(${-o/2}, ${a/2})`),h&&l.attr("style",h)}else l=lt(s,o,a,c);return r&&l.attr("style",r),t.width=o,t.height=a,W(t,l),t.intersect=function(g){return L.polygon(t,c,g)},s}),"lean_left"),Zt=w((i,t)=>C(void 0,null,function*(){let{labelStyles:e,nodeStyles:r}=N(t);t.labelStyle=e;let{shapeSvg:s,bbox:n}=yield z(i,t,j(t)),o=n.width+t.padding,a=n.height+t.padding,c=[{x:-3*a/6,y:0},{x:o+3*a/6,y:0},{x:o,y:-a},{x:0,y:-a}],l,{cssStyles:h}=t;if(t.look==="handDrawn"){let g=k.svg(s),f=A(t,{}),p=G(c),u=g.path(p,f);l=s.insert(()=>u,":first-child").attr("transform",`translate(${-o/2}, ${a/2})`),h&&l.attr("style",h)}else l=lt(s,o,a,c);return r&&l.attr("style",r),t.width=o,t.height=a,W(t,l),t.intersect=function(g){return L.polygon(t,c,g)},s}),"trapezoid"),Lt=w((i,t)=>C(void 0,null,function*(){let{labelStyles:e,nodeStyles:r}=N(t);t.labelStyle=e;let{shapeSvg:s,bbox:n}=yield z(i,t,j(t)),o=Math.max(n.width+(t.padding??0)*2,t?.width??0),a=Math.max(n.height+(t.padding??0)*2,t?.height??0),c=[{x:0,y:0},{x:o,y:0},{x:o+3*a/6,y:-a},{x:-3*a/6,y:-a}],l,{cssStyles:h}=t;if(t.look==="handDrawn"){let g=k.svg(s),f=A(t,{}),p=G(c),u=g.path(p,f);l=s.insert(()=>u,":first-child").attr("transform",`translate(${-o/2}, ${a/2})`),h&&l.attr("style",h)}else l=lt(s,o,a,c);return r&&l.attr("style",r),t.width=o,t.height=a,W(t,l),t.intersect=function(g){return L.polygon(t,c,g)},s}),"inv_trapezoid"),Pe=w((i,t)=>C(void 0,null,function*(){let{shapeSvg:e,bbox:r,label:s}=yield z(i,t,"label"),n=e.insert("rect",":first-child");return n.attr("width",.1).attr("height",.1),e.attr("class","label edgeLabel"),s.attr("transform",`translate(${-(r.width/2)-(r.x-(r.left??0))}, ${-(r.height/2)-(r.y-(r.top??0))})`),W(t,n),t.intersect=function(c){return L.rect(t,c)},e}),"labelRect"),Ma=w((i,t)=>C(void 0,null,function*(){let{labelStyles:e,nodeStyles:r}=N(t);t.labelStyle=e;let{shapeSvg:s,bbox:n,label:o}=yield z(i,t,j(t)),a=rt(F().flowchart?.htmlLabels),c=n.width+(t.padding??0),l=c+n.height,h=c+n.height,g=[{x:0,y:0},{x:h,y:0},{x:h/2,y:-l}],{cssStyles:f}=t,p=k.svg(s),u=A(t,{});t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let y=G(g),x=p.path(y,u),d=s.insert(()=>x,":first-child").attr("transform",`translate(${-l/2}, ${l/2})`);return f&&t.look!=="handDrawn"&&d.selectChildren("path").attr("style",f),r&&t.look!=="handDrawn"&&d.selectChildren("path").attr("style",r),t.width=c,t.height=l,W(t,d),o.attr("transform",`translate(${-n.width/2-(n.x-(n.left??0))}, ${l/2-(n.height+(t.padding??0)/(a?2:1)-(n.y-(n.top??0)))})`),t.intersect=function(b){return I.info("Triangle intersect",t,g,b),L.polygon(t,g,b)},s}),"triangle"),us=w((i,t)=>C(void 0,null,function*(){let{labelStyles:e,nodeStyles:r}=N(t);t.labelStyle=e;let s=80,n=50,{shapeSvg:o,bbox:a}=yield z(i,t,j(t)),c=Math.max(s,a.width+(t.padding??0)*2,t?.width??0),l=Math.max(n,a.height+(t.padding??0)*2,t?.height??0),h=l/2,{cssStyles:g}=t,f=k.svg(o),p=A(t,{});t.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");let u=[{x:-c/2,y:-l/2},{x:c/2-h,y:-l/2},...Ia(-c/2+h,0,h,50,90,270),{x:c/2-h,y:l/2},{x:-c/2,y:l/2}],y=G(u),x=f.path(y,p),d=o.insert(()=>x,":first-child");return d.attr("class","basic label-container"),g&&t.look!=="handDrawn"&&d.selectChildren("path").attr("style",g),r&&t.look!=="handDrawn"&&d.selectChildren("path").attr("style",r),W(t,d),t.intersect=function(b){return I.info("Pill intersect",t,{radius:h,point:b}),L.polygon(t,u,b)},o}),"halfRoundedRectangle"),$a=w((i,t)=>C(void 0,null,function*(){let{labelStyles:e,nodeStyles:r}=N(t);t.labelStyle=e;let{shapeSvg:s,bbox:n}=yield z(i,t,j(t)),o=80,a=20,c=Math.max(o,(n.width+(t.padding??0)*2)*1.25,t?.width??0),l=Math.max(a,n.height+(t.padding??0)*2,t?.height??0),h=l/2,{cssStyles:g}=t,f=k.svg(s),p=A(t,{});t.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");let u=c,y=l,x=u-h,d=y/4,b=[{x,y:0},{x:d,y:0},{x:0,y:y/2},{x:d,y},{x,y},...Ia(-x,-y/2,h,50,270,90)],m=G(b),S=f.path(m,p),v=s.insert(()=>S,":first-child");return v.attr("class","basic label-container"),g&&t.look!=="handDrawn"&&v.selectChildren("path").attr("style",g),r&&t.look!=="handDrawn"&&v.selectChildren("path").attr("style",r),v.attr("transform",`translate(${-c/2}, ${-l/2})`),W(t,v),t.intersect=function($){return L.polygon(t,b,$)},s}),"curvedTrapezoid"),Pa=w((i,t)=>C(void 0,null,function*(){let{labelStyles:e,nodeStyles:r}=N(t);t.labelStyle=e;let{shapeSvg:s,bbox:n,label:o}=yield z(i,t,j(t)),a=Math.max(n.width+(t.padding??0)*2,t?.width??0),c=Math.max(n.height+(t.padding??0)*2,t?.height??0),l=-a/2,h=-c/2,{cssStyles:g}=t,f=k.svg(s),p=A(t,{});t.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");let u=[{x:l,y:h},{x:l,y:h+c},{x:l+a,y:h+c},{x:l+a,y:h-c/2}],y=G(u),x=f.path(y,p),d=s.insert(()=>x,":first-child");return d.attr("class","basic label-container"),g&&t.look!=="handDrawn"&&d.selectChildren("path").attr("style",g),r&&t.look!=="handDrawn"&&d.selectChildren("path").attr("style",r),d.attr("transform",`translate(0, ${c/4})`),o.attr("transform",`translate(${-a/2+(t.padding??0)-(n.x-(n.left??0))}, ${-c/4+(t.padding??0)-(n.y-(n.top??0))})`),W(t,d),t.intersect=function(b){return L.polygon(t,u,b)},s}),"slopedRect");function Ha(i,t,e,r,s,n,o){let c=(i+e)/2,l=(t+r)/2,h=Math.atan2(r-t,e-i),g=(e-i)/2,f=(r-t)/2,p=g/s,u=f/n,y=Math.sqrt(p**2+u**2);if(y>1)throw new Error("The given radii are too small to create an arc between the points.");let x=Math.sqrt(1-y**2),d=c+x*n*Math.sin(h)*(o?-1:1),b=l-x*s*Math.cos(h)*(o?-1:1),m=Math.atan2((t-b)/n,(i-d)/s),v=Math.atan2((r-b)/n,(e-d)/s)-m;o&&v<0&&(v+=2*Math.PI),!o&&v>0&&(v-=2*Math.PI);let $=[];for(let D=0;D<20;D++){let M=D/19,R=m+M*v,E=d+s*Math.cos(R),Z=b+n*Math.sin(R);$.push({x:E,y:Z})}return $}w(Ha,"generateArcPoints");var Da=w((i,t)=>C(void 0,null,function*(){let{labelStyles:e,nodeStyles:r}=N(t);t.labelStyle=e;let{shapeSvg:s,bbox:n}=yield z(i,t,j(t)),o=n.width+t.padding+20,a=n.height+t.padding,c=a/2,l=c/(2.5+a/50),{cssStyles:h}=t,g=[{x:o/2,y:-a/2},{x:-o/2,y:-a/2},...Ha(-o/2,-a/2,-o/2,a/2,l,c,!1),{x:o/2,y:a/2},...Ha(o/2,a/2,o/2,-a/2,l,c,!0)],f=k.svg(s),p=A(t,{});t.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");let u=G(g),y=f.path(u,p),x=s.insert(()=>y,":first-child");return x.attr("class","basic label-container"),h&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",h),r&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",r),x.attr("transform",`translate(${l/2}, 0)`),W(t,x),t.intersect=function(d){return L.polygon(t,g,d)},s}),"bowTieRect"),Ft=w((i,t)=>C(void 0,null,function*(){let{labelStyles:e,nodeStyles:r}=N(t);t.labelStyle=e;let{shapeSvg:s,bbox:n,label:o}=yield z(i,t,j(t)),a=n.width+t.padding,c=n.height+t.padding,l=c*.2,h=-a/2,g=-c/2-l/2,{cssStyles:f}=t,p=k.svg(s),u=A(t,{});t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let y=[{x:h,y:g+l},{x:-h,y:g+l},{x:-h,y:-g},{x:h,y:-g},{x:h,y:g},{x:-h,y:g},{x:-h,y:g+l}],x=p.polygon(y.map(b=>[b.x,b.y]),u),d=s.insert(()=>x,":first-child");return d.attr("class","basic label-container"),f&&t.look!=="handDrawn"&&d.selectAll("path").attr("style",f),r&&t.look!=="handDrawn"&&d.selectAll("path").attr("style",r),o.attr("transform",`translate(${h+(t.padding??0)/2-(n.x-(n.left??0))}, ${g+l+(t.padding??0)/2-(n.y-(n.top??0))})`),W(t,d),t.intersect=function(b){return L.rect(t,b)},s}),"dividedRectangle");function Bs(i){let t=Math.cos(Math.PI/4),e=Math.sin(Math.PI/4),r=i*2,s={x:r/2*t,y:r/2*e},n={x:-(r/2)*t,y:r/2*e},o={x:-(r/2)*t,y:-(r/2)*e},a={x:r/2*t,y:-(r/2)*e};return`M ${n.x},${n.y} L ${a.x},${a.y}
                   M ${s.x},${s.y} L ${o.x},${o.y}`}w(Bs,"createLine");var La=w((i,t)=>{let{labelStyles:e,nodeStyles:r}=N(t);t.labelStyle=e,t.label="";let s=i.insert("g").attr("class",j(t)).attr("id",t.domId??t.id),n=Math.max(30,t?.width??0),{cssStyles:o}=t,a=k.svg(s),c=A(t,{});t.look!=="handDrawn"&&(c.roughness=0,c.fillStyle="solid");let l=a.circle(0,0,n*2,c),h=Bs(n),g=a.path(h,c),f=s.insert(()=>l,":first-child");return f.insert(()=>g),o&&t.look!=="handDrawn"&&f.selectAll("path").attr("style",o),r&&t.look!=="handDrawn"&&f.selectAll("path").attr("style",r),W(t,f),t.intersect=function(p){return I.info("crossedCircle intersect",t,{radius:n,point:p}),L.circle(t,n,p)},s},"crossedCircle"),ys=w((i,t)=>C(void 0,null,function*(){let{labelStyles:e,nodeStyles:r}=N(t);t.labelStyle=e;let{shapeSvg:s,bbox:n}=yield z(i,t,j(t)),o=100,a=50,c=Math.max(n.width+(t.padding??0)*2,t?.width??0),l=Math.max(n.height+(t.padding??0)*2,t?.height??0),h=c/l,g=c,f=l;g>f*h?f=g/h:g=f*h,g=Math.max(g,o),f=Math.max(f,a);let p=Math.min(f*.2,f/4),u=f+p*2,{cssStyles:y}=t,x=k.svg(s),d=A(t,{});t.look!=="handDrawn"&&(d.roughness=0,d.fillStyle="solid");let b=[{x:-g/2,y:u/2},...ot(-g/2,u/2,g/2,u/2,p,1),{x:g/2,y:-u/2},...ot(g/2,-u/2,-g/2,-u/2,p,-1)],m=G(b),S=x.path(m,d),v=s.insert(()=>S,":first-child");return v.attr("class","basic label-container"),y&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",y),r&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",r),W(t,v),t.intersect=function($){return L.polygon(t,b,$)},s}),"waveRectangle"),De=w((i,t,e,r,s,n)=>`M${i},${t}
    a${s},${n} 0,0,1 0,${-r}
    l${e},0
    a${s},${n} 0,0,1 0,${r}
    M${e},${-r}
    a${s},${n} 0,0,0 0,${r}
    l${-e},0`,"createCylinderPathD"),Le=w((i,t,e,r,s,n)=>[`M${i},${t}`,`M${i+e},${t}`,`a${s},${n} 0,0,0 0,${-r}`,`l${-e},0`,`a${s},${n} 0,0,0 0,${r}`,`l${e},0`].join(" "),"createOuterCylinderPathD"),Ce=w((i,t,e,r,s,n)=>[`M${i+e/2},${-r/2}`,`a${s},${n} 0,0,0 0,${r}`].join(" "),"createInnerCylinderPathD"),Ca=w((i,t)=>C(void 0,null,function*(){let{labelStyles:e,nodeStyles:r}=N(t);t.labelStyle=e;let{shapeSvg:s,bbox:n,label:o,halfPadding:a}=yield z(i,t,j(t)),c=t.look==="neo"?a*2:a,l=n.height+c,h=l/2,g=h/(2.5+l/50),f=n.width+g+c,{cssStyles:p}=t,u;if(t.look==="handDrawn"){let y=k.svg(s),x=Le(0,0,f,l,g,h),d=Ce(0,0,f,l,g,h),b=y.path(x,A(t,{})),m=y.path(d,A(t,{fill:"none"}));u=s.insert(()=>m,":first-child"),u=s.insert(()=>b,":first-child"),u.attr("class","basic label-container"),p&&u.attr("style",p)}else{let y=De(0,0,f,l,g,h);u=s.insert("path",":first-child").attr("d",y).attr("class","basic label-container").attr("style",p).attr("style",r)}return u.attr("class","basic label-container"),p&&t.look!=="handDrawn"&&u.selectAll("path").attr("style",p),r&&t.look!=="handDrawn"&&u.selectAll("path").attr("style",r),u.attr("label-offset-x",g),u.attr("transform",`translate(${-f/2}, ${l/2} )`),o.attr("transform",`translate(${-(n.width/2)-g-(n.x-(n.left??0))}, ${-(n.height/2)-(n.y-(n.top??0))})`),W(t,u),t.intersect=function(y){let x=L.rect(t,y),d=x.y-(t.y??0);if(h!=0&&(Math.abs(d)<(t.height??0)/2||Math.abs(d)==(t.height??0)/2&&Math.abs(x.x-(t.x??0))>(t.width??0)/2-g)){let b=g*g*(1-d*d/(h*h));b!=0&&(b=Math.sqrt(b)),b=g-b,y.x-(t.x??0)>0&&(b=-b),x.x+=b}return x},s}),"tiltedCylinder"),Ra=w((i,t)=>C(void 0,null,function*(){let{labelStyles:e,nodeStyles:r}=N(t);t.labelStyle=e;let{shapeSvg:s,bbox:n}=yield z(i,t,j(t)),o=60,a=20,c=Math.max(o,n.width+(t.padding??0)*2,t?.width??0),l=Math.max(a,n.height+(t.padding??0)*2,t?.height??0),{cssStyles:h}=t,g=k.svg(s),f=A(t,{});t.look!=="handDrawn"&&(f.roughness=0,f.fillStyle="solid");let p=[{x:-c/2*.8,y:-l/2},{x:c/2*.8,y:-l/2},{x:c/2,y:-l/2*.6},{x:c/2,y:l/2},{x:-c/2,y:l/2},{x:-c/2,y:-l/2*.6}],u=G(p),y=g.path(u,f),x=s.insert(()=>y,":first-child");return x.attr("class","basic label-container"),h&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",h),r&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",r),W(t,x),t.intersect=function(d){return L.polygon(t,p,d)},s}),"trapezoidalPentagon"),Aa=w((i,t)=>C(void 0,null,function*(){let{labelStyles:e,nodeStyles:r}=N(t);t.labelStyle=e;let{shapeSvg:s,bbox:n,label:o}=yield z(i,t,j(t)),a=n.width+(t.padding??0),c=a+n.height,l=a+n.height,h=[{x:0,y:-c},{x:l,y:-c},{x:l/2,y:0}],{cssStyles:g}=t,f=k.svg(s),p=A(t,{});t.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");let u=G(h),y=f.path(u,p),x=s.insert(()=>y,":first-child").attr("transform",`translate(${-c/2}, ${c/2})`);return g&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",g),r&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",r),t.width=a,t.height=c,W(t,x),o.attr("transform",`translate(${-n.width/2-(n.x-(n.left??0))}, ${-c/2+(t.padding??0)/2+(n.y-(n.top??0))})`),t.intersect=function(d){return I.info("Triangle intersect",t,h,d),L.polygon(t,h,d)},s}),"flippedTriangle"),ds=w((i,t)=>C(void 0,null,function*(){let{labelStyles:e,nodeStyles:r}=N(t);t.label="",t.labelStyle=e;let{shapeSvg:s}=yield z(i,t,j(t)),n=Math.max(30,t?.width??0),o=Math.max(30,t?.height??0),{cssStyles:a}=t,c=k.svg(s),l=A(t,{});t.look!=="handDrawn"&&(l.roughness=0,l.fillStyle="solid");let h=[{x:0,y:0},{x:n,y:0},{x:0,y:o},{x:n,y:o}],g=G(h),f=c.path(g,l),p=s.insert(()=>f,":first-child");return p.attr("class","basic label-container"),a&&t.look!=="handDrawn"&&p.selectChildren("path").attr("style",a),r&&t.look!=="handDrawn"&&p.selectChildren("path").attr("style",r),p.attr("transform",`translate(${-n/2}, ${-o/2})`),W(t,p),t.intersect=function(u){return I.info("Pill intersect",t,{points:h}),L.polygon(t,h,u)},s}),"hourglass"),Vt=w((i,t)=>C(void 0,null,function*(){let{labelStyles:e,nodeStyles:r}=N(t);t.labelStyle=e;let{shapeSvg:s,bbox:n}=yield z(i,t,j(t)),o=Math.max(n.width+(t.padding??0)*2,t?.width??0),a=Math.max(n.height+(t.padding??0)*2,t?.height??0),c=-o/2,l=-a/2,h=.2*a,g=.2*a,{cssStyles:f}=t,p=k.svg(s),u=A(t,{}),y=[{x:c-h/2,y:l},{x:c+o+h/2,y:l},{x:c+o+h/2,y:l+a},{x:c-h/2,y:l+a}],x=[{x:c+o-h/2,y:l+a},{x:c+o+h/2,y:l+a},{x:c+o+h/2,y:l+a-g}];t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let d=G(y),b=p.path(d,u),m=G(x),S=p.path(m,et(K({},u),{fillStyle:"solid"})),v=s.insert(()=>S,":first-child");return v.insert(()=>b,":first-child"),v.attr("class","basic label-container"),f&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",f),r&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",r),W(t,v),t.intersect=function($){return L.polygon(t,y,$)},s}),"taggedRect"),Qt=w((i,t)=>C(void 0,null,function*(){let{labelStyles:e,nodeStyles:r}=N(t);t.labelStyle=e;let{shapeSvg:s,bbox:n,label:o}=yield z(i,t,j(t)),a=Math.max(n.width+(t.padding??0)*2,t?.width??0),c=Math.max(n.height+(t.padding??0)*2,t?.height??0),l=5,h=-a/2,g=-c/2,{cssStyles:f}=t,p=k.svg(s),u=A(t,{}),y=[{x:h-l,y:g+l},{x:h-l,y:g+c+l},{x:h+a-l,y:g+c+l},{x:h+a-l,y:g+c},{x:h+a,y:g+c},{x:h+a,y:g+c-l},{x:h+a+l,y:g+c-l},{x:h+a+l,y:g-l},{x:h+l,y:g-l},{x:h+l,y:g},{x:h,y:g},{x:h,y:g+l}],x=[{x:h,y:g+l},{x:h+a-l,y:g+l},{x:h+a-l,y:g+c},{x:h+a,y:g+c},{x:h+a,y:g},{x:h,y:g}];t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let d=G(y),b=p.path(d,u),m=G(x),S=p.path(m,et(K({},u),{fill:"none"})),v=s.insert(()=>S,":first-child");return v.insert(()=>b,":first-child"),v.attr("class","basic label-container"),f&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",f),r&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",r),o.attr("transform",`translate(${-(n.width/2)-l-(n.x-(n.left??0))}, ${-(n.height/2)+l-(n.y-(n.top??0))})`),W(t,v),t.intersect=function($){return L.polygon(t,y,$)},s}),"multiRect"),Re=w((i,t,e,r,s,n,o)=>[`M${i},${t+n}`,`a${s},${n} 0,0,0 ${e},0`,`a${s},${n} 0,0,0 ${-e},0`,`l0,${r}`,`a${s},${n} 0,0,0 ${e},0`,`l0,${-r}`,`M${i},${t+n+o}`,`a${s},${n} 0,0,0 ${e},0`].join(" "),"createCylinderPathD"),Ae=w((i,t,e,r,s,n,o)=>[`M${i},${t+n}`,`M${i+e},${t+n}`,`a${s},${n} 0,0,0 ${-e},0`,`l0,${r}`,`a${s},${n} 0,0,0 ${e},0`,`l0,${-r}`,`M${i},${t+n+o}`,`a${s},${n} 0,0,0 ${e},0`].join(" "),"createOuterCylinderPathD"),Be=w((i,t,e,r,s,n)=>[`M${i-e/2},${-r/2}`,`a${s},${n} 0,0,0 ${e},0`].join(" "),"createInnerCylinderPathD"),Ba=w((i,t)=>C(void 0,null,function*(){let{labelStyles:e,nodeStyles:r}=N(t);t.labelStyle=e;let{shapeSvg:s,bbox:n,label:o}=yield z(i,t,j(t)),a=Math.max(n.width+(t.padding??0),t.width??0),c=a/2,l=c/(2.5+a/50),h=Math.max(n.height+l+(t.padding??0),t.height??0),g=h*.1,f,{cssStyles:p}=t;if(t.look==="handDrawn"){let u=k.svg(s),y=Ae(0,0,a,h,c,l,g),x=Be(0,l,a,h,c,l),d=A(t,{}),b=u.path(y,d),m=u.path(x,d);s.insert(()=>m,":first-child").attr("class","line"),f=s.insert(()=>b,":first-child"),f.attr("class","basic label-container"),p&&f.attr("style",p)}else{let u=Re(0,0,a,h,c,l,g);f=s.insert("path",":first-child").attr("d",u).attr("class","basic label-container").attr("style",p).attr("style",r)}return f.attr("label-offset-y",l),f.attr("transform",`translate(${-a/2}, ${-(h/2+l)})`),W(t,f),o.attr("transform",`translate(${-(n.width/2)-(n.x-(n.left??0))}, ${-(n.height/2)+l-(n.y-(n.top??0))})`),t.intersect=function(u){let y=L.rect(t,u),x=y.x-(t.x??0);if(c!=0&&(Math.abs(x)<(t.width??0)/2||Math.abs(x)==(t.width??0)/2&&Math.abs(y.y-(t.y??0))>(t.height??0)/2-l)){let d=l*l*(1-x*x/(c*c));d>0&&(d=Math.sqrt(d)),d=l-d,u.y-(t.y??0)>0&&(d=-d),y.y+=d}return y},s}),"linedCylinder"),xs=w((i,t)=>C(void 0,null,function*(){let{labelStyles:e,nodeStyles:r}=N(t);t.labelStyle=e;let{shapeSvg:s,bbox:n,label:o}=yield z(i,t,j(t)),a=Math.max(n.width+(t.padding??0)*2,t?.width??0),c=Math.max(n.height+(t.padding??0)*2,t?.height??0),l=c/8,h=c+l,{cssStyles:g}=t,p=70-a,u=p>0?p/2:0,y=k.svg(s),x=A(t,{});t.look!=="handDrawn"&&(x.roughness=0,x.fillStyle="solid");let d=[{x:-a/2-u,y:h/2},...ot(-a/2-u,h/2,a/2+u,h/2,l,.8),{x:a/2+u,y:-h/2},{x:-a/2-u,y:-h/2}],b=G(d),m=y.path(b,x),S=s.insert(()=>m,":first-child");return S.attr("class","basic label-container"),g&&t.look!=="handDrawn"&&S.selectAll("path").attr("style",g),r&&t.look!=="handDrawn"&&S.selectAll("path").attr("style",r),S.attr("transform",`translate(0,${-l/2})`),o.attr("transform",`translate(${-a/2+(t.padding??0)-(n.x-(n.left??0))},${-c/2+(t.padding??0)-l-(n.y-(n.top??0))})`),W(t,S),t.intersect=function(v){return L.polygon(t,d,v)},s}),"waveEdgedRectangle"),Wa=w((i,t)=>{let{labelStyles:e,nodeStyles:r}=N(t);t.label="",t.labelStyle=e;let s=i.insert("g").attr("class",j(t)).attr("id",t.domId??t.id),{cssStyles:n}=t,o=Math.max(35,t?.width??0),a=Math.max(35,t?.height??0),c=7,l=[{x:o,y:0},{x:0,y:a+c/2},{x:o-2*c,y:a+c/2},{x:0,y:2*a},{x:o,y:a-c/2},{x:2*c,y:a-c/2}],h=k.svg(s),g=A(t,{});t.look!=="handDrawn"&&(g.roughness=0,g.fillStyle="solid");let f=G(l),p=h.path(f,g),u=s.insert(()=>p,":first-child");return n&&t.look!=="handDrawn"&&u.selectAll("path").attr("style",n),r&&t.look!=="handDrawn"&&u.selectAll("path").attr("style",r),u.attr("transform",`translate(-${o/2},${-a})`),W(t,u),t.intersect=function(y){return I.info("lightningBolt intersect",t,y),L.polygon(t,l,y)},s},"lightningBolt"),Na=w((i,t,{config:{themeVariables:e}})=>{let{labelStyles:r,nodeStyles:s}=N(t);t.label="",t.labelStyle=r;let n=i.insert("g").attr("class",j(t)).attr("id",t.domId??t.id),o=7,{cssStyles:a}=t,c=k.svg(n),{nodeBorder:l}=e,h=A(t,{fillStyle:"solid"});t.look!=="handDrawn"&&(h.roughness=0);let g=c.circle(0,0,o*2,h),f=n.insert(()=>g,":first-child");return f.selectAll("path").attr("style",`fill: ${l} !important;`),a&&a.length>0&&t.look!=="handDrawn"&&f.selectAll("path").attr("style",a),s&&t.look!=="handDrawn"&&f.selectAll("path").attr("style",s),W(t,f),t.intersect=function(p){return I.info("filledCircle intersect",t,{radius:o,point:p}),L.circle(t,o,p)},n},"filledCircle"),Ut=w((i,t)=>C(void 0,null,function*(){let{labelStyles:e,nodeStyles:r}=N(t);t.labelStyle=e;let{shapeSvg:s,bbox:n,label:o}=yield z(i,t,j(t)),a=Math.max(n.width+(t.padding??0)*2,t?.width??0),c=Math.max(n.height+(t.padding??0)*2,t?.height??0),l=c/4,h=c+l,g=-a/2,f=-h/2,p=5,{cssStyles:u}=t,y=ot(g-p,f+h+p,g+a-p,f+h+p,l,.8),x=y?.[y.length-1],d=[{x:g-p,y:f+p},{x:g-p,y:f+h+p},...y,{x:g+a-p,y:x.y-p},{x:g+a,y:x.y-p},{x:g+a,y:x.y-2*p},{x:g+a+p,y:x.y-2*p},{x:g+a+p,y:f-p},{x:g+p,y:f-p},{x:g+p,y:f},{x:g,y:f},{x:g,y:f+p}],b=[{x:g,y:f+p},{x:g+a-p,y:f+p},{x:g+a-p,y:x.y-p},{x:g+a,y:x.y-p},{x:g+a,y:f},{x:g,y:f}],m=k.svg(s),S=A(t,{});t.look!=="handDrawn"&&(S.roughness=0,S.fillStyle="solid");let v=G(d),$=m.path(v,S),D=G(b),M=m.path(D,S),R=s.insert(()=>$,":first-child");return R.insert(()=>M),R.attr("class","basic label-container"),u&&t.look!=="handDrawn"&&R.selectAll("path").attr("style",u),r&&t.look!=="handDrawn"&&R.selectAll("path").attr("style",r),R.attr("transform",`translate(0,${-l/2})`),o.attr("transform",`translate(${-(n.width/2)-p-(n.x-(n.left??0))}, ${-(n.height/2)+p-l/2-(n.y-(n.top??0))})`),W(t,R),t.intersect=function(E){return L.polygon(t,d,E)},s}),"multiWaveEdgedRectangle"),Ea=w((i,t)=>C(void 0,null,function*(){let{labelStyles:e,nodeStyles:r}=N(t);t.labelStyle=e;let{shapeSvg:s,bbox:n,label:o}=yield z(i,t,j(t)),a=Math.max(n.width+(t.padding??0)*2,t?.width??0),c=Math.max(n.height+(t.padding??0)*2,t?.height??0),l=5,h=-a/2,g=-c/2,{cssStyles:f}=t,p=k.svg(s),u=A(t,{}),y=[{x:h-l,y:g-l},{x:h-l,y:g+c},{x:h+a,y:g+c},{x:h+a,y:g-l}],x=`M${h-l},${g-l} L${h+a},${g-l} L${h+a},${g+c} L${h-l},${g+c} L${h-l},${g-l}
                M${h-l},${g} L${h+a},${g}
                M${h},${g-l} L${h},${g+c}`;t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let d=p.path(x,u),b=s.insert(()=>d,":first-child");return b.attr("transform",`translate(${l/2}, ${l/2})`),b.attr("class","basic label-container"),f&&t.look!=="handDrawn"&&b.selectAll("path").attr("style",f),r&&t.look!=="handDrawn"&&b.selectAll("path").attr("style",r),o.attr("transform",`translate(${-(n.width/2)+l/2-(n.x-(n.left??0))}, ${-(n.height/2)+l/2-(n.y-(n.top??0))})`),W(t,b),t.intersect=function(m){return L.polygon(t,y,m)},s}),"windowPane"),bs=w((i,t)=>C(void 0,null,function*(){let{labelStyles:e,nodeStyles:r}=N(t);t.labelStyle=e;let{shapeSvg:s,bbox:n,label:o}=yield z(i,t,j(t)),a=Math.max(n.width+(t.padding??0)*2,t?.width??0),c=Math.max(n.height+(t.padding??0)*2,t?.height??0),l=c/4,h=c+l,{cssStyles:g}=t,f=k.svg(s),p=A(t,{});t.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");let u=[{x:-a/2-a/2*.1,y:-h/2},{x:-a/2-a/2*.1,y:h/2},...ot(-a/2-a/2*.1,h/2,a/2+a/2*.1,h/2,l,.8),{x:a/2+a/2*.1,y:-h/2},{x:-a/2-a/2*.1,y:-h/2},{x:-a/2,y:-h/2},{x:-a/2,y:h/2*1.1},{x:-a/2,y:-h/2}],y=f.polygon(u.map(d=>[d.x,d.y]),p),x=s.insert(()=>y,":first-child");return x.attr("class","basic label-container"),g&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",g),r&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",r),x.attr("transform",`translate(0,${-l/2})`),o.attr("transform",`translate(${-a/2+(t.padding??0)+a/2*.1/2-(n.x-(n.left??0))},${-c/2+(t.padding??0)-l/2-(n.y-(n.top??0))})`),W(t,x),t.intersect=function(d){return L.polygon(t,u,d)},s}),"linedWaveEdgedRect"),ws=w((i,t)=>C(void 0,null,function*(){let{labelStyles:e,nodeStyles:r}=N(t);t.labelStyle=e;let{shapeSvg:s,bbox:n,label:o}=yield z(i,t,j(t)),a=Math.max(n.width+(t.padding??0)*2,t?.width??0),c=Math.max(n.height+(t.padding??0)*2,t?.height??0),l=c/4,h=.2*a,g=.2*c,f=c+l,{cssStyles:p}=t,u=k.svg(s),y=A(t,{});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");let x=[{x:-a/2-a/2*.1,y:f/2},...ot(-a/2-a/2*.1,f/2,a/2+a/2*.1,f/2,l,.8),{x:a/2+a/2*.1,y:-f/2},{x:-a/2-a/2*.1,y:-f/2}],d=-a/2+a/2*.1,b=-f/2-g*.4,m=[{x:d+a-h,y:(b+c)*1.4},{x:d+a,y:b+c-g},{x:d+a,y:(b+c)*.9},...ot(d+a,(b+c)*1.3,d+a-h,(b+c)*1.5,-c*.03,.5)],S=G(x),v=u.path(S,y),$=G(m),D=u.path($,et(K({},y),{fillStyle:"solid"})),M=s.insert(()=>D,":first-child");return M.insert(()=>v,":first-child"),M.attr("class","basic label-container"),p&&t.look!=="handDrawn"&&M.selectAll("path").attr("style",p),r&&t.look!=="handDrawn"&&M.selectAll("path").attr("style",r),M.attr("transform",`translate(0,${-l/2})`),o.attr("transform",`translate(${-a/2+(t.padding??0)-(n.x-(n.left??0))},${-c/2+(t.padding??0)-l/2-(n.y-(n.top??0))})`),W(t,M),t.intersect=function(R){return L.polygon(t,x,R)},s}),"taggedWaveEdgedRectangle");function nt(i,t,e,r=100,s=0,n=180){let o=[],a=s*Math.PI/180,h=(n*Math.PI/180-a)/(r-1);for(let g=0;g<r;g++){let f=a+g*h,p=i+e*Math.cos(f),u=t+e*Math.sin(f);o.push({x:-p,y:-u})}return o}w(nt,"generateCirclePoints");var Ta=w((i,t)=>C(void 0,null,function*(){let{labelStyles:e,nodeStyles:r}=N(t);t.labelStyle=e;let{shapeSvg:s,bbox:n,label:o}=yield z(i,t,j(t)),a=n.width+(t.padding??0),c=n.height+(t.padding??0),l=Math.max(5,c*.1),{cssStyles:h}=t,g=[...nt(a/2,-c/2,l,30,-90,0),{x:-a/2-l,y:l},...nt(a/2+l*2,-l,l,20,-180,-270),...nt(a/2+l*2,l,l,20,-90,-180),{x:-a/2-l,y:-c/2},...nt(a/2,c/2,l,20,0,90)],f=[{x:a/2,y:-c/2-l},{x:-a/2,y:-c/2-l},...nt(a/2,-c/2,l,20,-90,0),{x:-a/2-l,y:-l},...nt(a/2+a*.1,-l,l,20,-180,-270),...nt(a/2+a*.1,l,l,20,-90,-180),{x:-a/2-l,y:c/2},...nt(a/2,c/2,l,20,0,90),{x:-a/2,y:c/2+l},{x:a/2,y:c/2+l}],p=k.svg(s),u=A(t,{fill:"none"});t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let x=G(g).replace("Z",""),d=p.path(x,u),b=G(f),m=p.path(b,K({},u)),S=s.insert("g",":first-child");return S.insert(()=>m,":first-child").attr("stroke-opacity",0),S.insert(()=>d,":first-child"),S.attr("class","text"),h&&t.look!=="handDrawn"&&S.selectAll("path").attr("style",h),r&&t.look!=="handDrawn"&&S.selectAll("path").attr("style",r),S.attr("transform",`translate(${l}, 0)`),o.attr("transform",`translate(${-a/2+l-(n.x-(n.left??0))},${-c/2+(t.padding??0)/2-(n.y-(n.top??0))})`),W(t,S),t.intersect=function(v){return L.polygon(t,f,v)},s}),"curlyBraceLeft");function it(i,t,e,r=100,s=0,n=180){let o=[],a=s*Math.PI/180,h=(n*Math.PI/180-a)/(r-1);for(let g=0;g<r;g++){let f=a+g*h,p=i+e*Math.cos(f),u=t+e*Math.sin(f);o.push({x:p,y:u})}return o}w(it,"generateCirclePoints");var We=w((i,t)=>C(void 0,null,function*(){let{labelStyles:e,nodeStyles:r}=N(t);t.labelStyle=e;let{shapeSvg:s,bbox:n,label:o}=yield z(i,t,j(t)),a=n.width+(t.padding??0),c=n.height+(t.padding??0),l=Math.max(5,c*.1),{cssStyles:h}=t,g=[...it(a/2,-c/2,l,20,-90,0),{x:a/2+l,y:-l},...it(a/2+l*2,-l,l,20,-180,-270),...it(a/2+l*2,l,l,20,-90,-180),{x:a/2+l,y:c/2},...it(a/2,c/2,l,20,0,90)],f=[{x:-a/2,y:-c/2-l},{x:a/2,y:-c/2-l},...it(a/2,-c/2,l,20,-90,0),{x:a/2+l,y:-l},...it(a/2+l*2,-l,l,20,-180,-270),...it(a/2+l*2,l,l,20,-90,-180),{x:a/2+l,y:c/2},...it(a/2,c/2,l,20,0,90),{x:a/2,y:c/2+l},{x:-a/2,y:c/2+l}],p=k.svg(s),u=A(t,{fill:"none"});t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let x=G(g).replace("Z",""),d=p.path(x,u),b=G(f),m=p.path(b,K({},u)),S=s.insert("g",":first-child");return S.insert(()=>m,":first-child").attr("stroke-opacity",0),S.insert(()=>d,":first-child"),S.attr("class","text"),h&&t.look!=="handDrawn"&&S.selectAll("path").attr("style",h),r&&t.look!=="handDrawn"&&S.selectAll("path").attr("style",r),S.attr("transform",`translate(${-l}, 0)`),o.attr("transform",`translate(${-a/2+(t.padding??0)/2-(n.x-(n.left??0))},${-c/2+(t.padding??0)/2-(n.y-(n.top??0))})`),W(t,S),t.intersect=function(v){return L.polygon(t,f,v)},s}),"curlyBraceRight");function Q(i,t,e,r=100,s=0,n=180){let o=[],a=s*Math.PI/180,h=(n*Math.PI/180-a)/(r-1);for(let g=0;g<r;g++){let f=a+g*h,p=i+e*Math.cos(f),u=t+e*Math.sin(f);o.push({x:-p,y:-u})}return o}w(Q,"generateCirclePoints");var Ne=w((i,t)=>C(void 0,null,function*(){let{labelStyles:e,nodeStyles:r}=N(t);t.labelStyle=e;let{shapeSvg:s,bbox:n,label:o}=yield z(i,t,j(t)),a=n.width+(t.padding??0),c=n.height+(t.padding??0),l=Math.max(5,c*.1),{cssStyles:h}=t,g=[...Q(a/2,-c/2,l,30,-90,0),{x:-a/2-l,y:l},...Q(a/2+l*2,-l,l,20,-180,-270),...Q(a/2+l*2,l,l,20,-90,-180),{x:-a/2-l,y:-c/2},...Q(a/2,c/2,l,20,0,90)],f=[...Q(-a/2+l+l/2,-c/2,l,20,-90,-180),{x:a/2-l/2,y:l},...Q(-a/2-l/2,-l,l,20,0,90),...Q(-a/2-l/2,l,l,20,-90,0),{x:a/2-l/2,y:-l},...Q(-a/2+l+l/2,c/2,l,30,-180,-270)],p=[{x:a/2,y:-c/2-l},{x:-a/2,y:-c/2-l},...Q(a/2,-c/2,l,20,-90,0),{x:-a/2-l,y:-l},...Q(a/2+l*2,-l,l,20,-180,-270),...Q(a/2+l*2,l,l,20,-90,-180),{x:-a/2-l,y:c/2},...Q(a/2,c/2,l,20,0,90),{x:-a/2,y:c/2+l},{x:a/2-l-l/2,y:c/2+l},...Q(-a/2+l+l/2,-c/2,l,20,-90,-180),{x:a/2-l/2,y:l},...Q(-a/2-l/2,-l,l,20,0,90),...Q(-a/2-l/2,l,l,20,-90,0),{x:a/2-l/2,y:-l},...Q(-a/2+l+l/2,c/2,l,30,-180,-270)],u=k.svg(s),y=A(t,{fill:"none"});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");let d=G(g).replace("Z",""),b=u.path(d,y),S=G(f).replace("Z",""),v=u.path(S,y),$=G(p),D=u.path($,K({},y)),M=s.insert("g",":first-child");return M.insert(()=>D,":first-child").attr("stroke-opacity",0),M.insert(()=>b,":first-child"),M.insert(()=>v,":first-child"),M.attr("class","text"),h&&t.look!=="handDrawn"&&M.selectAll("path").attr("style",h),r&&t.look!=="handDrawn"&&M.selectAll("path").attr("style",r),M.attr("transform",`translate(${l-l/4}, 0)`),o.attr("transform",`translate(${-a/2+(t.padding??0)/2-(n.x-(n.left??0))},${-c/2+(t.padding??0)/2-(n.y-(n.top??0))})`),W(t,M),t.intersect=function(R){return L.polygon(t,p,R)},s}),"curlyBraces"),Ee=w((s,n,o)=>C(void 0,[s,n,o],function*(i,t,{config:{themeVariables:e,flowchart:r}}){let{labelStyles:a}=N(t);t.labelStyle=a;let c=t.assetHeight??48,l=t.assetWidth??48,h=Math.max(c,l),g=r?.wrappingWidth;t.width=Math.max(h,g??0);let{shapeSvg:f,bbox:p,halfPadding:u,label:y}=yield z(i,t,"icon-shape default"),x=t.pos==="t",d=h+u*2,b=h+u*2,{nodeBorder:m,mainBkg:S}=e,{stylesMap:v}=bt(t),$=-b/2,D=-d/2,M=t.label?8:0,R=k.svg(f),E=A(t,{stroke:v.get("fill")||S});t.look!=="handDrawn"&&(E.roughness=0,E.fillStyle="solid");let Z=R.rectangle($,D,b,d,E),V=Math.max(b,p.width),q=d+p.height+M,X=R.rectangle(-V/2,-q/2,V,q,et(K({},E),{fill:"transparent",stroke:"none"})),Y=f.insert(()=>Z,":first-child"),B=f.insert(()=>X);if(t.icon){let O=f.append("g");O.html(`<g>${yield wt(t.icon,{height:h,width:h,fallbackPrefix:""})}</g>`);let P=O.node().getBBox(),H=P.width,_=P.height,st=P.x,ht=P.y;O.attr("transform",`translate(${-H/2-st},${x?p.height/2+M/2-_/2-ht:-p.height/2-M/2-_/2-ht})`),O.selectAll("path").attr("fill",v.get("stroke")??m)}return y.attr("transform",`translate(${-p.width/2-(p.x-(p.left??0))},${x?-q/2:q/2-p.height})`),Y.attr("transform",`translate(0,${x?p.height/2+M/2:-p.height/2-M/2})`),W(t,B),t.intersect=function(O){if(I.info("iconSquare intersect",t,O),!t.label)return L.rect(t,O);let P=t.x??0,H=t.y??0,_=t.height??0,st=[];return x?st=[{x:P-p.width/2,y:H-_/2},{x:P+p.width/2,y:H-_/2},{x:P+p.width/2,y:H-_/2+p.height+M},{x:P+b/2,y:H-_/2+p.height+M},{x:P+b/2,y:H+_/2},{x:P-b/2,y:H+_/2},{x:P-b/2,y:H-_/2+p.height+M},{x:P-p.width/2,y:H-_/2+p.height+M}]:st=[{x:P-b/2,y:H-_/2},{x:P+b/2,y:H-_/2},{x:P+b/2,y:H-_/2+d},{x:P+p.width/2,y:H-_/2+d},{x:P+p.width/2/2,y:H+_/2},{x:P-p.width/2,y:H+_/2},{x:P-p.width/2,y:H-_/2+d},{x:P-b/2,y:H-_/2+d}],L.polygon(t,st,O)},f}),"iconSquare"),Te=w((s,n,o)=>C(void 0,[s,n,o],function*(i,t,{config:{themeVariables:e,flowchart:r}}){let{labelStyles:a}=N(t);t.labelStyle=a;let c=t.assetHeight??48,l=t.assetWidth??48,h=Math.max(c,l),g=r?.wrappingWidth;t.width=Math.max(h,g??0);let{shapeSvg:f,bbox:p,label:u}=yield z(i,t,"icon-shape default"),y=20,x=t.label?8:0,d=t.pos==="t",{nodeBorder:b,mainBkg:m}=e,{stylesMap:S}=bt(t),v=k.svg(f),$=A(t,{stroke:S.get("fill")||m});t.look!=="handDrawn"&&($.roughness=0,$.fillStyle="solid");let D=f.append("g");t.icon&&D.html(`<g>${yield wt(t.icon,{height:h,width:h,fallbackPrefix:""})}</g>`);let M=D.node().getBBox(),R=M.width,E=M.height,Z=M.x,V=M.y,q=Math.max(R,E)*Math.SQRT2+y*2,X=v.circle(0,0,q,$),Y=Math.max(q,p.width),B=q+p.height+x,O=v.rectangle(-Y/2,-B/2,Y,B,et(K({},$),{fill:"transparent",stroke:"none"})),P=f.insert(()=>X,":first-child"),H=f.insert(()=>O);return D.attr("transform",`translate(${-R/2-Z},${d?p.height/2+x/2-E/2-V:-p.height/2-x/2-E/2-V})`),D.selectAll("path").attr("fill",S.get("stroke")||b),u.attr("transform",`translate(${-p.width/2-(p.x-(p.left??0))},${d?-B/2:B/2-p.height})`),P.attr("transform",`translate(0,${d?p.height/2+x/2:-p.height/2-x/2})`),W(t,H),t.intersect=function(_){return I.info("iconSquare intersect",t,_),L.rect(t,_)},f}),"iconCircle"),Oe=w((s,n,o)=>C(void 0,[s,n,o],function*(i,t,{config:{themeVariables:e,flowchart:r}}){let{labelStyles:a}=N(t);t.labelStyle=a;let c=t.assetHeight??48,l=t.assetWidth??48,h=Math.max(c,l),g=r?.wrappingWidth;t.width=Math.max(h,g??0);let{shapeSvg:f,bbox:p,label:u}=yield z(i,t,"icon-shape default"),y=t.pos==="t",x=h,d=h,{nodeBorder:b}=e,{stylesMap:m}=bt(t),S=-d/2,v=-x/2,$=t.label?8:0,D=k.svg(f),M=A(t,{stroke:"none",fill:"none"});t.look!=="handDrawn"&&(M.roughness=0,M.fillStyle="solid");let R=D.rectangle(S,v,d,x,M),E=Math.max(d,p.width),Z=x+p.height+$,V=D.rectangle(-E/2,-Z/2,E,Z,et(K({},M),{fill:"transparent",stroke:"none"})),q=f.insert(()=>R,":first-child"),X=f.insert(()=>V);if(t.icon){let Y=f.append("g");Y.html(`<g>${yield wt(t.icon,{height:h,width:h,fallbackPrefix:""})}</g>`);let B=Y.node().getBBox(),O=B.width,P=B.height,H=B.x,_=B.y;Y.attr("transform",`translate(${-O/2-H},${y?p.height/2+$/2-P/2-_:-p.height/2-$/2-P/2-_})`),Y.selectAll("path").attr("fill",m.get("stroke")||b)}return u.attr("transform",`translate(${-p.width/2-(p.x-(p.left??0))},${y?-Z/2:Z/2-p.height})`),q.attr("transform",`translate(0,${y?p.height/2+$/2:-p.height/2-$/2})`),W(t,X),t.intersect=function(Y){if(I.info("iconSquare intersect",t,Y),!t.label)return L.rect(t,Y);let B=t.x??0,O=t.y??0,P=t.height??0,H=[];return y?H=[{x:B-p.width/2,y:O-P/2},{x:B+p.width/2,y:O-P/2},{x:B+p.width/2,y:O-P/2+p.height+$},{x:B+d/2,y:O-P/2+p.height+$},{x:B+d/2,y:O+P/2},{x:B-d/2,y:O+P/2},{x:B-d/2,y:O-P/2+p.height+$},{x:B-p.width/2,y:O-P/2+p.height+$}]:H=[{x:B-d/2,y:O-P/2},{x:B+d/2,y:O-P/2},{x:B+d/2,y:O-P/2+x},{x:B+p.width/2,y:O-P/2+x},{x:B+p.width/2/2,y:O+P/2},{x:B-p.width/2,y:O+P/2},{x:B-p.width/2,y:O-P/2+x},{x:B-d/2,y:O-P/2+x}],L.polygon(t,H,Y)},f}),"icon"),_e=w((r,s,n)=>C(void 0,[r,s,n],function*(i,t,{config:{flowchart:e}}){let o=new Image;o.src=t?.img??"",yield o.decode();let a=Number(o.naturalWidth.toString().replace("px","")),c=Number(o.naturalHeight.toString().replace("px",""));t.imageAspectRatio=a/c;let{labelStyles:l}=N(t);t.labelStyle=l;let h=e?.wrappingWidth;t.defaultWidth=e?.wrappingWidth;let g=Math.max(t.label?h??0:0,t?.assetWidth??a),f=t.constraint==="on"&&t?.assetHeight?t.assetHeight*t.imageAspectRatio:g,p=t.constraint==="on"?f/t.imageAspectRatio:t?.assetHeight??c;t.width=Math.max(f,h??0);let{shapeSvg:u,bbox:y,label:x}=yield z(i,t,"image-shape default"),d=t.pos==="t",b=-f/2,m=-p/2,S=t.label?8:0,v=k.svg(u),$=A(t,{});t.look!=="handDrawn"&&($.roughness=0,$.fillStyle="solid");let D=v.rectangle(b,m,f,p,$),M=Math.max(f,y.width),R=p+y.height+S,E=v.rectangle(-M/2,-R/2,M,R,et(K({},$),{fill:"none",stroke:"none"})),Z=u.insert(()=>D,":first-child"),V=u.insert(()=>E);if(t.img){let q=u.append("image");q.attr("href",t.img),q.attr("width",f),q.attr("height",p),q.attr("preserveAspectRatio","none"),q.attr("transform",`translate(${-f/2},${d?R/2-p:-R/2})`)}return x.attr("transform",`translate(${-y.width/2-(y.x-(y.left??0))},${d?-p/2-y.height/2-S/2:p/2-y.height/2+S/2})`),Z.attr("transform",`translate(0,${d?y.height/2+S/2:-y.height/2-S/2})`),W(t,V),t.intersect=function(q){if(I.info("iconSquare intersect",t,q),!t.label)return L.rect(t,q);let X=t.x??0,Y=t.y??0,B=t.height??0,O=[];return d?O=[{x:X-y.width/2,y:Y-B/2},{x:X+y.width/2,y:Y-B/2},{x:X+y.width/2,y:Y-B/2+y.height+S},{x:X+f/2,y:Y-B/2+y.height+S},{x:X+f/2,y:Y+B/2},{x:X-f/2,y:Y+B/2},{x:X-f/2,y:Y-B/2+y.height+S},{x:X-y.width/2,y:Y-B/2+y.height+S}]:O=[{x:X-f/2,y:Y-B/2},{x:X+f/2,y:Y-B/2},{x:X+f/2,y:Y-B/2+p},{x:X+y.width/2,y:Y-B/2+p},{x:X+y.width/2/2,y:Y+B/2},{x:X-y.width/2,y:Y+B/2},{x:X-y.width/2,y:Y-B/2+p},{x:X-f/2,y:Y-B/2+p}],L.polygon(t,O,q)},u}),"imageSquare"),He=w((s,n,o)=>C(void 0,[s,n,o],function*(i,t,{config:{themeVariables:e,flowchart:r}}){let{labelStyles:a}=N(t);t.labelStyle=a;let c=t.assetHeight??48,l=t.assetWidth??48,h=Math.max(c,l),g=r?.wrappingWidth;t.width=Math.max(h,g??0);let{shapeSvg:f,bbox:p,halfPadding:u,label:y}=yield z(i,t,"icon-shape default"),x=t.pos==="t",d=h+u*2,b=h+u*2,{nodeBorder:m,mainBkg:S}=e,{stylesMap:v}=bt(t),$=-b/2,D=-d/2,M=t.label?8:0,R=k.svg(f),E=A(t,{stroke:v.get("fill")||S});t.look!=="handDrawn"&&(E.roughness=0,E.fillStyle="solid");let Z=R.path(xt($,D,b,d,5),E),V=Math.max(b,p.width),q=d+p.height+M,X=R.rectangle(-V/2,-q/2,V,q,et(K({},E),{fill:"transparent",stroke:"none"})),Y=f.insert(()=>Z,":first-child"),B=f.insert(()=>X);if(t.icon){let O=f.append("g");O.html(`<g>${yield wt(t.icon,{height:h,width:h,fallbackPrefix:""})}</g>`);let P=O.node().getBBox(),H=P.width,_=P.height,st=P.x,ht=P.y;O.attr("transform",`translate(${-H/2-st},${x?p.height/2+M/2-_/2-ht:-p.height/2-M/2-_/2-ht})`),O.selectAll("path").attr("fill",v.get("stroke")??m)}return y.attr("transform",`translate(${-p.width/2-(p.x-(p.left??0))},${x?-q/2:q/2-p.height})`),Y.attr("transform",`translate(0,${x?p.height/2+M/2:-p.height/2-M/2})`),W(t,B),t.intersect=function(O){if(I.info("iconSquare intersect",t,O),!t.label)return L.rect(t,O);let P=t.x??0,H=t.y??0,_=t.height??0,st=[];return x?st=[{x:P-p.width/2,y:H-_/2},{x:P+p.width/2,y:H-_/2},{x:P+p.width/2,y:H-_/2+p.height+M},{x:P+b/2,y:H-_/2+p.height+M},{x:P+b/2,y:H+_/2},{x:P-b/2,y:H+_/2},{x:P-b/2,y:H-_/2+p.height+M},{x:P-p.width/2,y:H-_/2+p.height+M}]:st=[{x:P-b/2,y:H-_/2},{x:P+b/2,y:H-_/2},{x:P+b/2,y:H-_/2+d},{x:P+p.width/2,y:H-_/2+d},{x:P+p.width/2/2,y:H+_/2},{x:P-p.width/2,y:H+_/2},{x:P-p.width/2,y:H-_/2+d},{x:P-b/2,y:H-_/2+d}],L.polygon(t,st,O)},f}),"iconRounded"),Oa={state:de,stateStart:zt,stateEnd:jt,forkJoin:ma,choice:xe,note:be,rectWithTitle:we,roundedRect:wa,squareRect:$t,rectangle:$t,rect:$t,process:$t,proc:$t,rounded:wa,event:wa,stadium:ka,pill:ka,terminal:ka,subroutine:Pt,"framed-rectangle":Pt,"fr-rect":Pt,subprocess:Pt,subproc:Pt,cylinder:Xt,db:Xt,cyl:Xt,database:Xt,question:Yt,diam:Yt,diamond:Yt,decision:Yt,hexagon:va,hex:va,prepare:va,lean_right:qt,"lean-r":qt,"lean-right":qt,"in-out":qt,lean_left:Gt,"lean-l":Gt,"lean-left":Gt,"out-in":Gt,trapezoid:Zt,"trap-b":Zt,"trapezoid-bottom":Zt,priority:Zt,inv_trapezoid:Lt,"inv-trapezoid":Lt,"trapezoid-top":Lt,"trap-t":Lt,manual:Lt,doublecircle:Sa,"dbl-circ":Sa,"double-circle":Sa,circle:gs,circ:gs,rect_left_inv_arrow:fs,odd:fs,card:Jt,"notched-rectangle":Jt,"notch-rect":Jt,"lined-rectangle":Dt,"lin-rect":Dt,"lin-proc":Dt,"lined-process":Dt,"shaded-process":Dt,"small-circle":zt,"sm-circ":zt,start:zt,stop:jt,"framed-circle":jt,"fr-circ":jt,join:ma,fork:ma,comment:Ta,"brace-l":Ta,bolt:Wa,"com-link":Wa,"lightning-bolt":Wa,doc:xs,document:xs,delay:us,"half-rounded-rectangle":us,"horizontal-cylinder":Ca,"h-cyl":Ca,das:Ca,"lined-cylinder":Ba,"lin-cyl":Ba,disk:Ba,"curved-trapezoid":$a,"curv-trap":$a,display:$a,"divided-rectangle":Ft,"div-rect":Ft,"div-proc":Ft,"divided-process":Ft,triangle:Ma,tri:Ma,extract:Ma,"window-pane":Ea,"win-pane":Ea,"internal-storage":Ea,"f-circ":Na,junction:Na,"filled-circle":Na,"lin-doc":bs,"lined-document":bs,"notched-pentagon":Ra,"notch-pent":Ra,"loop-limit":Ra,"flipped-triangle":Aa,"flip-tri":Aa,"manual-file":Aa,"sloped-rectangle":Pa,"sl-rect":Pa,"manual-input":Pa,docs:Ut,documents:Ut,"st-doc":Ut,"stacked-document":Ut,processes:Qt,procs:Qt,"stacked-rectangle":Qt,"st-rect":Qt,flag:ys,"paper-tape":ys,"bow-tie-rectangle":Da,"bow-rect":Da,"stored-data":Da,"crossed-circle":La,"cross-circ":La,summary:La,"tag-doc":ws,"tagged-document":ws,"tag-rect":Vt,"tagged-rectangle":Vt,"tag-proc":Vt,"tagged-process":Vt,hourglass:ds,collate:ds,text:As,anchor:$e,brace:Ta,labelRect:Pe,"brace-r":We,braces:Ne,iconSquare:Ee,iconCircle:Te,icon:Oe,iconRounded:He,imageSquare:_e},dt=new Map,rn=w((i,t,e)=>C(void 0,null,function*(){let r,s;if(t.shape==="rect"&&(t.rx&&t.ry?t.shape="roundedRect":t.shape="squareRect"),!Oa[t.shape])throw new Error(`No such shape: ${t.shape}. Please check your syntax.`);if(t.link){let n;e.config.securityLevel==="sandbox"?n="_top":t.linkTarget&&(n=t.linkTarget||"_blank"),r=i.insert("svg:a").attr("xlink:href",t.link).attr("target",n),s=yield Oa[t.shape](r,t,e)}else s=yield Oa[t.shape](i,t,e),r=s;return t.tooltip&&s.attr("title",t.tooltip),dt.set(t.id,r),t.haveCallback&&dt.get(t.id).attr("class",dt.get(t.id).attr("class")+" clickable"),r}),"insertNode"),nn=w((i,t)=>{dt.set(t.id,i)},"setNodeElem"),ln=w(()=>{dt.clear()},"clear"),cn=w(i=>{let t=dt.get(i.id);I.trace("Transforming node",i.diff,i,"translate("+(i.x-i.width/2-5)+", "+i.width/2+")");let e=8,r=i.diff||0;return i.clusterNode?t.attr("transform","translate("+(i.x+r-i.width/2)+", "+(i.y-i.height/2-e)+")"):t.attr("transform","translate("+i.x+", "+i.y+")"),r},"positionNode");export{Ve as a,Qe as b,Ke as c,tr as d,ar as e,sr as f,er as g,z as h,W as i,rn as j,nn as k,ln as l,cn as m};
